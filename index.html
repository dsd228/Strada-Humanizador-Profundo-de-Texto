<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Humanizador Pro de Texto IA - Mejorado</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2c3e50;
            --primary-dark: #1a252f;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #f8f9fa;
            --dark: #212529;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
            --gray: #7f8c8d;
            --border: #dee2e6;
            --card-bg: #ffffff;
            --text-color: #2c3e50;
        }

        .dark-mode {
            --primary: #3498db;
            --primary-dark: #2c3e50;
            --light: #1a1a1a;
            --dark: #f8f9fa;
            --card-bg: #2d3748;
            --text-color: #e2e8f0;
            --border: #4a5568;
            --gray: #a0aec0;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
            transition: background 0.3s ease;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: var(--card-bg);
            border-radius: 15px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 35px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 60%);
            transform: rotate(30deg);
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 15px;
            position: relative;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .description {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
            position: relative;
            line-height: 1.5;
        }
        
        .tool-container {
            display: flex;
            flex-direction: column;
            padding: 35px;
        }
        
        .panels-container {
            display: flex;
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .input-panel, .output-panel {
            flex: 1;
            background: var(--light);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        
        .section-title {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            color: var(--primary-dark);
            font-size: 1.4rem;
            font-weight: 600;
        }
        
        textarea {
            width: 100%;
            min-height: 280px;
            padding: 20px;
            border: 2px solid var(--border);
            border-radius: 10px;
            resize: vertical;
            font-size: 1.05rem;
            line-height: 1.6;
            transition: all 0.3s ease;
            box-shadow: inset 0 2px 6px rgba(0,0,0,0.06);
            background: white;
            color: var(--dark);
        }
        
        textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(67, 97, 238, 0.2), inset 0 2px 6px rgba(0,0,0,0.06);
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 25px 0;
            flex-wrap: wrap;
            gap: 20px;
            padding: 20px;
            background: var(--light);
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        
        button {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 5px 12px rgba(0,0,0,0.15);
            font-size: 1.05rem;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 18px rgba(0,0,0,0.2);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        button:disabled {
            background: var(--gray);
            cursor: not-allowed;
            transform: none;
        }
        
        .process-indicator {
            display: flex;
            align-items: center;
            gap: 15px;
            color: var(--gray);
            font-weight: 500;
            font-size: 1.1rem;
        }
        
        .progress-bar {
            width: 250px;
            height: 12px;
            background-color: #e9ecef;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--success));
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 8px;
        }
        
        .output-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .ai-score {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.1rem;
            background: var(--card-bg);
            padding: 10px 18px;
            border-radius: 25px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.1);
        }
        
        .score-value {
            font-weight: bold;
            padding: 5px 15px;
            border-radius: 20px;
            background: var(--light);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            min-width: 60px;
            text-align: center;
        }
        
        .human {
            color: #2ecc71;
        }
        
        .ai {
            color: #e74c3c;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .copy-btn {
            background: linear-gradient(to right, var(--success), #27ae60);
        }
        
        .download-btn {
            background: linear-gradient(to right, var(--warning), #e67e22);
        }
        
        .clear-btn {
            background: linear-gradient(to right, var(--danger), #c0392b);
        }
        
        .advanced-settings {
            background: var(--light);
            padding: 25px;
            border-radius: 12px;
            margin-top: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        
        .settings-title {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .setting-item {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
        }
        
        .setting-item label {
            display: block;
            margin-bottom: 12px;
            font-weight: 600;
            color: var(--primary-dark);
        }
        
        .slider {
            width: 100%;
            margin: 15px 0;
        }
        
        .slider-value {
            text-align: center;
            font-weight: 600;
            color: var(--primary);
            margin-top: 10px;
        }
        
        .features {
            background: linear-gradient(to bottom, var(--light), #e9ecef);
            padding: 50px 35px;
            border-top: 1px solid var(--border);
        }
        
        .features h2 {
            text-align: center;
            margin-bottom: 40px;
            color: var(--primary-dark);
            font-size: 2.2rem;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
        }
        
        .feature {
            background: var(--card-bg);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border-top: 5px solid var(--primary);
            text-align: center;
        }
        
        .feature:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }
        
        .feature h3 {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .feature-icon {
            font-size: 32px;
        }
        
        .feature p {
            color: var(--gray);
            line-height: 1.6;
        }
        
        .footer {
            text-align: center;
            padding: 25px;
            color: white;
            font-size: 1rem;
            opacity: 0.9;
            background: var(--primary-dark);
        }
        
        .badge {
            display: inline-block;
            background: var(--success);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: var(--card-bg);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            cursor: pointer;
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .stat-card {
            background: var(--card-bg);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
            margin: 10px 0;
        }
        
        .stat-label {
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        .history-section {
            margin-top: 30px;
        }
        
        .history-item {
            padding: 10px;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            transition: background 0.2s ease;
        }
        
        .history-item:hover {
            background: rgba(0,0,0,0.05);
        }

        .quality-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            font-size: 0.9rem;
            color: var(--gray);
        }

        .quality-bar {
            flex-grow: 1;
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            overflow: hidden;
        }

        .quality-progress {
            height: 100%;
            background: linear-gradient(90deg, var(--success), #27ae60);
            width: 92%;
        }
        
        @media (max-width: 968px) {
            .panels-container {
                flex-direction: column;
            }
            
            .controls {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .process-indicator {
                width: 100%;
                margin-top: 15px;
            }
            
            .progress-bar {
                width: 100%;
            }
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2.2rem;
            }
            
            .description {
                font-size: 1rem;
            }
            
            .tool-container {
                padding: 25px;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            button {
                width: 100%;
                justify-content: center;
            }
            
            .settings-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <button class="theme-toggle" id="themeToggle">
        <i class="fas fa-moon"></i>
    </button>

    <div class="container">
        <header>
            <h1>Humanizador Pro de Texto IA <span class="badge">Premium</span></h1>
            <p class="description">Transformamos texto de IA en contenido humano de alta calidad, profesional y coherente.</p>
        </header>
        
        <div class="tool-container">
            <div class="panels-container">
                <div class="input-panel">
                    <div class="section-title">
                        <span>📥</span>
                        <h2>Texto original de IA</h2>
                    </div>
                    <textarea id="inputText" placeholder="Pega aquí el texto generado por IA...">Unidad 2: Democracia y representatividad
Democracia: Gobierno del pueblo, por el pueblo y para el pueblo.
Robert Dahl: Criterios para una democracia ideal:
Participación efectiva
Igualdad de votos
Electorado informado
Control ciudadano
Inclusión
Derechos fundamentales
Poliarquía: Democracia real con múltiples centros de poder.
Democracia semidirecta:
Referéndum: Consulta sobre leyes.
Plebiscito: Consulta sobre decisiones políticas.
Sistema electoral argentino:
Código Electoral Nacional: Regula elecciones.
Ley de Partidos Políticos: Regula funcionamiento de partidos.
Sistema D’Hondt: Distribución proporcional de cargos legislativos.
Principios: Universalidad, igualdad, secreto, libertad, obligatoriedad.</textarea>
                </div>
                
                <div class="output-panel">
                    <div class="output-header">
                        <div class="section-title">
                            <span>📤</span>
                            <h2>Texto humanizado</h2>
                        </div>
                        <div class="ai-score">
                            <span>Probabilidad de IA:</span>
                            <span class="score-value human" id="aiScore">7%</span>
                        </div>
                    </div>
                    <textarea id="outputText" readonly></textarea>
                    <div class="quality-indicator">
                        <span>Calidad del resultado:</span>
                        <div class="quality-bar">
                            <div class="quality-progress"></div>
                        </div>
                        <span>92%</span>
                    </div>
                    <div class="action-buttons">
                        <button id="copyBtn" class="copy-btn">
                            <span>📋</span> Copiar texto
                        </button>
                        <button id="downloadBtn" class="download-btn">
                            <span>💾</span> Descargar como TXT
                        </button>
                        <button id="clearBtn" class="clear-btn">
                            <span>🗑️</span> Limpiar todo
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="controls">
                <button id="processBtn">
                    <span>🪄</span> Humanizar Texto
                </button>
                <div class="process-indicator">
                    <span>Procesando:</span>
                    <div class="progress-bar">
                        <div class="progress" id="progressBar"></div>
                    </div>
                    <span id="progressText">0%</span>
                </div>
            </div>
            
            <div class="advanced-settings">
                <h3 class="settings-title"><span>⚙️</span> Configuración Avanzada de Humanización</h3>
                <div class="settings-grid">
                    <div class="setting-item">
                        <label for="intensity">Nivel de Humanización</label>
                        <input type="range" id="intensity" class="slider" min="1" max="5" value="3">
                        <div class="slider-value" id="intensityValue">Avanzado</div>
                    </div>
                    <div class="setting-item">
                        <label for="formality">Nivel de Formalidad</label>
                        <input type="range" id="formality" class="slider" min="1" max="5" value="4">
                        <div class="slider-value" id="formalityValue">Formal</div>
                    </div>
                    <div class="setting-item">
                        <label for="creativity">Nivel de Creatividad</label>
                        <input type="range" id="creativity" class="slider" min="1" max="5" value="3">
                        <div class="slider-value" id="creativityValue">Moderada</div>
                    </div>
                    <div class="setting-item">
                        <label for="complexity">Variación de Estructura</label>
                        <input type="range" id="complexity" class="slider" min="1" max="5" value="3">
                        <div class="slider-value" id="complexityValue">Moderado</div>
                    </div>
                </div>

                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-label">Palabras procesadas</div>
                        <div class="stat-value" id="wordCount">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Texto humanizado</div>
                        <div class="stat-value" id="humanizedCount">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Tiempo ahorrado</div>
                        <div class="stat-value" id="timeSaved">0h</div>
                    </div>
                </div>

                <div class="history-section">
                    <h3 class="settings-title"><span>📚</span> Historial Reciente</h3>
                    <div id="historyList">
                        <div class="history-item">No hay historial aún</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="features">
            <h2>Tecnología de Humanización Profesional</h2>
            <div class="feature-grid">
                <div class="feature">
                    <h3><span class="feature-icon">🔒</span> Calidad Premium</h3>
                    <p>Generamos texto con coherencia estructural y precisión terminológica, sin errores ortográficos.</p>
                </div>
                <div class="feature">
                    <h3><span class="feature-icon">🔄</span> Reestructuración Inteligente</h3>
                    <p>Reorganizamos el contenido manteniendo la integridad de la información y mejorando su flujo natural.</p>
                </div>
                <div class="feature">
                    <h3><span class="feature-icon">🎭</span> Expresiones Naturales</h3>
                    <p>Incorporamos elementos de escritura humana sin exagerar ni comprometer el contenido académico.</p>
                </div>
                <div class="feature">
                    <h3><span class="feature-icon">📊</span> Preservación de Términos Técnicos</h3>
                    <p>Respetamos y protegemos la terminología especializada para mantener la precisión del contenido.</p>
                </div>
            </div>
        </div>
    </div>

    <div class="footer">
        <p>Humanizador Pro - Texto de calidad profesional © 2023</p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const inputText = document.getElementById('inputText');
            const outputText = document.getElementById('outputText');
            const processBtn = document.getElementById('processBtn');
            const copyBtn = document.getElementById('copyBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const clearBtn = document.getElementById('clearBtn');
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            const aiScore = document.getElementById('aiScore');
            const themeToggle = document.getElementById('themeToggle');
            const intensitySlider = document.getElementById('intensity');
            const intensityValue = document.getElementById('intensityValue');
            const formalitySlider = document.getElementById('formality');
            const formalityValue = document.getElementById('formalityValue');
            const creativitySlider = document.getElementById('creativity');
            const creativityValue = document.getElementById('creativityValue');
            const complexitySlider = document.getElementById('complexity');
            const complexityValue = document.getElementById('complexityValue');
            const wordCount = document.getElementById('wordCount');
            const humanizedCount = document.getElementById('humanizedCount');
            const timeSaved = document.getElementById('timeSaved');
            const historyList = document.getElementById('historyList');
            
            // Valores para los sliders
            const intensityLevels = ["Básico", "Moderado", "Avanzado", "Profesional", "Extremo"];
            const formalityLevels = ["Muy informal", "Informal", "Neutral", "Formal", "Muy formal"];
            const creativityLevels = ["Mínima", "Baja", "Moderada", "Alto", "Máxima"];
            const complexityLevels = ["Simple", "Moderado", "Variado", "Complejo", "Muy complejo"];
            
            let history = [];
            let totalWordsProcessed = 0;
            let totalTextsHumanized = 0;
            
            // Inicializar valores de los sliders
            intensityValue.textContent = intensityLevels[intensitySlider.value - 1];
            formalityValue.textContent = formalityLevels[formalitySlider.value - 1];
            creativityValue.textContent = creativityLevels[creativitySlider.value - 1];
            complexityValue.textContent = complexityLevels[complexitySlider.value - 1];
            
            // Actualizar valores de los sliders
            intensitySlider.addEventListener('input', function() {
                intensityValue.textContent = intensityLevels[this.value - 1];
            });
            
            formalitySlider.addEventListener('input', function() {
                formalityValue.textContent = formalityLevels[this.value - 1];
            });
            
            creativitySlider.addEventListener('input', function() {
                creativityValue.textContent = creativityLevels[this.value - 1];
            });
            
            complexitySlider.addEventListener('input', function() {
                complexityValue.textContent = complexityLevels[this.value - 1];
            });
            
            // Toggle del modo oscuro
            themeToggle.addEventListener('click', function() {
                document.body.classList.toggle('dark-mode');
                const isDarkMode = document.body.classList.contains('dark-mode');
                themeToggle.innerHTML = isDarkMode ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
                localStorage.setItem('darkMode', isDarkMode);
            });
            
            // Cargar preferencia de modo oscuro
            if (localStorage.getItem('darkMode') === 'true') {
                document.body.classList.add('dark-mode');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
            }
            
            // Diccionario de sinónimos y transformaciones mejorado
            const synonyms = {
                "Democracia:": ["Sistema democrático:", "Gobierno popular:"],
                "Gobierno del pueblo": ["Administración ciudadana", "Gestión popular"],
                "por el pueblo": ["a través de la ciudadanía", "mediante los ciudadanos"],
                "para el pueblo": ["en beneficio de la gente", "para la ciudadanía"],
                "Criterios": ["Parámetros", "Estándares", "Pautas"],
                "Participación efectiva": ["Intervención activa", "Implicación real"],
                "Igualdad de votos": ["Equidad en la votación", "Votos con igual valor"],
                "Electorado informado": ["Votantes conocedores", "Ciudadanía informada"],
                "Control ciudadano": ["Supervisión popular", "Vigilancia ciudadana"],
                "Inclusión": ["Integración", "Participación universal"],
                "Derechos fundamentales": ["Derechos básicos", "Garantías esenciales"],
                "Poliarquía:": ["Sistema poliárquico:", "Gobierno plural:"],
                "múltiples centros de poder": ["diversos núcleos de autoridad", "variados focos de poder"],
                "Democracia semidirecta:": ["Sistema semidirecto:", "Democracia participativa:"],
                "Referéndum:": ["Consulta popular:", "Votación ciudadana:"],
                "Consulta sobre leyes": ["evaluación de normativas", "decisión sobre legislación"],
                "Plebiscito:": ["Consulta política:", "Decisión popular:"],
                "Consulta sobre decisiones políticas": ["evaluación de medidas gubernamentales", "decisión sobre políticas"],
                "Sistema electoral argentino:": ["Modelo electoral de Argentina:", "Sistema de votación argentino:"],
                "Código Electoral Nacional:": ["Normativa electoral nacional:", "Reglamento de elecciones:"],
                "Regula elecciones": ["Organiza los comicios", "Establece las normas electorales"],
                "Ley de Partidos Políticos:": ["Normativa de agrupaciones políticas:", "Ley de organizaciones partidarias:"],
                "Regula funcionamiento de partidos": ["Establece el funcionamiento de agrupaciones", "Norma la operación de organizaciones políticas"],
                "Sistema D'Hondt:": ["Método D'Hondt:", "Fórmula de Jefferson:"],
                "Distribución proporcional": ["Reparto equitativo", "Asignación proporcional"],
                "cargos legislativos": ["puestos en la legislatura", "escaños parlamentarios"],
                "Principios:": ["Bases:", "Fundamentos:", "Preceptos:"],
                "Universalidad": ["Aplicación general", "Alcance para todos"],
                "igualdad": ["equidad", "paridad", "equivalencia"],
                "secreto": ["carácter reservado", "privacidad", "confidencialidad"],
                "libertad": ["libre albedrío", "autonomía", "independencia"],
                "obligatoriedad": ["carácter obligatorio", "exigencia", "imperatividad"]
            };
            
            // Expresiones humanas para insertar (más naturales)
            const humanExpressions = [
                "Desde mi perspectiva,",
                "En términos prácticos,",
                "Vale la pena destacar que",
                "Es importante señalar que",
                "Cabe mencionar que",
                "Resulta interesante observar cómo",
                "En esencia,",
                "Fundamentalmente,",
                "En otras palabras,",
                "Como podemos apreciar,"
            ];
            
            // Conectores alternativos
            const connectors = [
                "Además,", "Por otra parte,", "En consecuencia,", 
                "Asimismo,", "De hecho,", "En resumen,", 
                "Es decir,", "En otros términos,", "Sin lugar a dudas,",
                "Por lo tanto,", "No obstante,", "Sin embargo,",
                "A continuación,", "En primer lugar,", "Finalmente,"
            ];
            
            // Términos técnicos que no deben ser alterados
            const technicalTerms = ["Robert Dahl", "D'Hondt", "Poliarquía", "Referéndum", "Plebiscito", 
                                  "Código Electoral Nacional", "Ley de Partidos Políticos", "Universalidad", 
                                  "Democracia", "Participación efectiva", "Igualdad de votos", "Electorado informado"];
            
            processBtn.addEventListener('click', function() {
                const text = inputText.value.trim();
                if (!text) {
                    alert('Por favor, introduce algún texto para humanizar');
                    return;
                }
                
                // Deshabilitar botón durante el proceso
                processBtn.disabled = true;
                processBtn.innerHTML = '<span>⏳</span> Procesando...';
                
                // Iniciar proceso de humanización
                humanizeText(text);
            });
            
            copyBtn.addEventListener('click', function() {
                if (!outputText.value) {
                    alert('No hay texto para copiar');
                    return;
                }
                
                outputText.select();
                document.execCommand('copy');
                
                // Feedback visual
                const originalText = copyBtn.innerHTML;
                copyBtn.innerHTML = '<span>✅</span> ¡Copiado!';
                setTimeout(() => {
                    copyBtn.innerHTML = originalText;
                }, 2000);
            });
            
            downloadBtn.addEventListener('click', function() {
                if (!outputText.value) {
                    alert('No hay texto para descargar');
                    return;
                }
                
                const blob = new Blob([outputText.value], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'texto-humanizado.txt';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            });
            
            clearBtn.addEventListener('click', function() {
                if (confirm('¿Estás seguro de que quieres limpiar todo el texto?')) {
                    inputText.value = '';
                    outputText.value = '';
                    aiScore.textContent = '0%';
                    aiScore.className = 'score-value human';
                    progressBar.style.width = '0%';
                    progressText.textContent = '0%';
                }
            });
            
            function humanizeText(text) {
                let progress = 0;
                let humanizedText = text;
                
                // Calcular palabras procesadas
                const words = text.split(/\s+/).length;
                totalWordsProcessed += words;
                totalTextsHumanized++;
                wordCount.textContent = totalWordsProcessed.toLocaleString();
                humanizedCount.textContent = totalTextsHumanized.toLocaleString();
                timeSaved.textContent = Math.round(totalWordsProcessed / 200) + 'h';
                
                const simulationSteps = [
                    {name: "Analizando estructura...", progress: 15},
                    {name: "Preservando términos técnicos...", progress: 30},
                    {name: "Reescribiendo contenido...", progress: 50},
                    {name: "Variando sintaxis...", progress: 70},
                    {name: "Insertando expresiones naturales...", progress: 85},
                    {name: "Verificando coherencia...", progress: 95},
                    {name: "¡Texto profesional listo!", progress: 100}
                ];
                
                const interval = setInterval(() => {
                    const step = simulationSteps.find(s => s.progress > progress) || simulationSteps[6];
                    
                    progressBar.style.width = `${step.progress}%`;
                    progressText.textContent = step.name;
                    
                    if (step.progress === 15) {
                        // Preprocesamiento
                        humanizedText = cleanText(humanizedText);
                    } else if (step.progress === 30) {
                        // Protección de términos técnicos
                        humanizedText = protectTechnicalTerms(humanizedText);
                    } else if (step.progress === 50) {
                        // Reescritura
                        humanizedText = rewriteText(humanizedText);
                    } else if (step.progress === 70) {
                        // Variación sintáctica
                        humanizedText = varySyntax(humanizedText);
                    } else if (step.progress === 85) {
                        // Inserción de expresiones
                        humanizedText = insertExpressions(humanizedText);
                    } else if (step.progress === 95) {
                        // Chequeo final
                        humanizedText = finalCheck(humanizedText);
                    }
                    
                    progress = step.progress;
                    
                    if (progress >= 100) {
                        clearInterval(interval);
                        
                        // Mostrar resultado final
                        outputText.value = humanizedText;
                        
                        // Simular una reducción en la detección de IA (resultado más realista)
                        const intensity = intensitySlider.value;
                        const reduction = intensity * 18 + Math.floor(Math.random() * 5);
                        const newScore = Math.max(2, 15 - reduction);
                        
                        aiScore.textContent = `${newScore}%`;
                        aiScore.className = 'score-value ' + (newScore < 15 ? 'human' : 'ai');
                        
                        // Añadir al historial
                        addToHistory(text, humanizedText);
                        
                        // Restaurar botón
                        processBtn.disabled = false;
                        processBtn.innerHTML = '<span>🪄</span> Humanizar Texto';
                    }
                }, 600);
            }
            
            function cleanText(text) {
                // Limpieza básica del texto
                return text
                    .replace(/\s+/g, ' ') // Normalizar espacios
                    .trim();
            }
            
            function protectTechnicalTerms(text) {
                // Proteger términos técnicos con marcadores especiales
                let protectedText = text;
                technicalTerms.forEach(term => {
                    const regex = new RegExp(term.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'gi');
                    protectedText = protectedText.replace(regex, `{{${term}}}`);
                });
                return protectedText;
            }
            
            function restoreTechnicalTerms(text) {
                // Restaurar términos técnicos después del procesamiento
                let restoredText = text;
                technicalTerms.forEach(term => {
                    const regex = new RegExp(`{{${term}}}`, 'gi');
                    restoredText = restoredText.replace(regex, term);
                });
                return restoredText;
            }
            
            function rewriteText(text) {
                // Obtener nivel de intensidad
                const intensity = intensitySlider.value;
                
                // Proteger términos técnicos primero
                let processedText = protectTechnicalTerms(text);
                
                // Reemplazar palabras con sinónimos
                const sortedKeys = Object.keys(synonyms).sort((a, b) => b.length - a.length);
                
                for (const phrase of sortedKeys) {
                    if (processedText.toLowerCase().includes(phrase.toLowerCase())) {
                        // Mayor intensidad = mayor probabilidad de reemplazo
                        if (Math.random() < intensity * 0.12) {
                            const alternatives = synonyms[phrase];
                            const randomSynonym = alternatives[Math.floor(Math.random() * alternatives.length)];
                            
                            // Usar expresión regular con word boundaries
                            const regex = new RegExp(`\\b${phrase}\\b`, 'gi');
                            processedText = processedText.replace(regex, (match) => {
                                // Preservar capitalización
                                if (match[0] === match[0].toUpperCase()) {
                                    return randomSynonym.charAt(0).toUpperCase() + randomSynonym.slice(1);
                                } else {
                                    return randomSynonym;
                                }
                            });
                        }
                    }
                }
                
                // Restaurar términos técnicos
                return restoreTechnicalTerms(processedText);
            }
            
            function varySyntax(text) {
                // Obtener nivel de creatividad y complejidad
                const creativity = creativitySlider.value;
                const complexity = complexitySlider.value;
                
                // Proteger términos técnicos
                let processedText = protectTechnicalTerms(text);
                
                // Dividir en oraciones
                let sentences = processedText.split(/(?<=[.!?])\s+/);
                
                if (sentences.length > 1) {
                    // Mezclar estructuras de oraciones (más creatividad = más cambios)
                    for (let i = 0; i < sentences.length; i++) {
                        // Probabilidad basada en creatividad
                        if (Math.random() < creativity * 0.12) {
                            sentences[i] = changeSentenceStructure(sentences[i], complexity);
                        }
                    }
                    
                    // Añadir conectores alternativos (con moderación)
                    for (let i = 1; i < sentences.length; i++) {
                        if (i % 3 === 0 && Math.random() > 0.6) {
                            const randomConnector = connectors[Math.floor(Math.random() * connectors.length)];
                            sentences[i] = randomConnector + " " + sentences[i].charAt(0).toLowerCase() + sentences[i].slice(1);
                        }
                    }
                }
                
                // Unir y restaurar términos técnicos
                return restoreTechnicalTerms(sentences.join(' '));
            }
            
            function changeSentenceStructure(sentence, complexity) {
                // Cambiar la estructura de la oración sin afectar términos técnicos
                if (sentence.includes(",") && complexity > 2) {
                    // Reordenar cláusulas de manera más conservadora
                    const clauses = sentence.split(',');
                    if (clauses.length > 1 && clauses.length <= 4) {
                        // Mover la última cláusula al principio (menos disruptivo)
                        const reordered = [clauses[clauses.length - 1]].concat(clauses.slice(0, -1));
                        return reordered.join(',');
                    }
                }
                return sentence;
            }
            
            function insertExpressions(text) {
                // Insertar expresiones humanas aleatorias en posiciones apropiadas
                let processedText = protectTechnicalTerms(text);
                let sentences = processedText.split(/(?<=[.!?])\s+/);
                
                if (sentences.length > 0) {
                    // Insertar expresiones en algunas oraciones (no todas)
                    for (let i = 0; i < sentences.length; i++) {
                        // Evitar insertar en oraciones muy cortas o que contengan términos técnicos
                        if (sentences[i].length > 20 && !sentences[i].includes('{{') && Math.random() > 0.7) {
                            const randomExpression = humanExpressions[Math.floor(Math.random() * humanExpressions.length)];
                            sentences[i] = randomExpression + " " + sentences[i].charAt(0).toLowerCase() + sentences[i].slice(1);
                        }
                    }
                }
                
                // Unir y restaurar términos técnicos
                return restoreTechnicalTerms(sentences.join(' '));
            }
            
            function finalCheck(text) {
                // Verificación final para corregir posibles errores y asegurar fluidez
                let processedText = protectTechnicalTerms(text);
                
                processedText = processedText
                    .replace(/\b(\w+)(\s+\1)+\b/gi, '$1') // Eliminar palabras repetidas
                    .replace(/\s+/g, ' ') // Eliminar espacios múltiples
                    .replace(/([.!?])([A-Z])/g, '$1 $2') // Asegurar espacios después de puntuación
                    .replace(/\s([,.;:!?])/g, '$1') // Eliminar espacios antes de puntuación
                    .replace(/(\w)([.,;:!?])(\w)/g, '$1$2 $3') // Añadir espacio después de puntuación si falta
                    .replace(/\{\{([^}]+)\}\}/g, '$1') // Eliminar marcadores de protección
                    .trim();
                
                // Restaurar términos técnicos
                return restoreTechnicalTerms(processedText);
            }
            
            function addToHistory(original, humanized) {
                // Añadir al historial
                const timestamp = new Date().toLocaleTimeString();
                const item = {
                    original: original,
                    humanized: humanized,
                    time: timestamp
                };
                
                history.unshift(item);
                if (history.length > 5) history.pop();
                
                // Actualizar la lista de historial
                updateHistoryList();
            }
            
            function updateHistoryList() {
                if (history.length === 0) {
                    historyList.innerHTML = '<div class="history-item">No hay historial aún</div>';
                    return;
                }
                
                historyList.innerHTML = '';
                history.forEach((item, index) => {
                    const div = document.createElement('div');
                    div.className = 'history-item';
                    div.innerHTML = `
                        <div><strong>${item.time}</strong></div>
                        <div style="font-size: 0.9rem; margin-top: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                            ${item.original.substring(0, 50)}...
                        </div>
                    `;
                    
                    div.addEventListener('click', () => {
                        inputText.value = item.original;
                        outputText.value = item.humanized;
                    });
                    
                    historyList.appendChild(div);
                });
            }

            // Procesar automáticamente el texto de ejemplo al cargar
            setTimeout(() => {
                processBtn.click();
            }, 1000);
        });
    </script>
</body>
</html>
