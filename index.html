<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RedactaPro Supremo - Profesional con Iconos</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/docx@7.11.0/build/index.browser.js"></script>
    <!-- Lucide Icons CDN -->
    <script src="https://unpkg.com/lucide@latest/dist/cdn/lucide.min.js"></script>
    <style>
        :root {
            --bg: #ffffff;
            --bg-sidebar: #f8f9fa;
            --text: #1f2937;
            --text-secondary: #4b5563;
            --accent: #1d4ed8;
            --accent-light: #3b82f6;
            --border: #e5e7eb;
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            --success: #059669;
            --warning: #d97706;
            --danger: #dc2626;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            padding: 0;
            margin: 0;
            min-height: 100vh;
            display: flex;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: var(--bg-sidebar);
            border-right: 1px solid var(--border);
            padding: 20px;
            height: 100vh;
            overflow-y: auto;
            position: fixed;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.05);
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent);
            margin-bottom: 20px;
            text-align: center;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tool-section {
            margin-bottom: 25px;
        }

        .tool-title {
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-weight: 600;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .tool-btn {
            display: block;
            width: 100%;
            padding: 8px 12px;
            margin-bottom: 6px;
            background: white;
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text);
            font-size: 0.9rem;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tool-btn:hover {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }

        .tool-btn i {
            width: 18px;
            height: 18px;
        }

        /* Main content */
        .main-content {
            margin-left: 280px;
            padding: 30px;
            width: calc(100% - 280px);
        }

        h1 {
            color: var(--accent);
            margin: 0 0 10px 0;
            font-weight: 700;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        p.subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
            margin-bottom: 25px;
        }

        /* Form */
        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        textarea {
            width: 100%;
            min-height: 200px;
            padding: 16px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: white;
            color: var(--text);
            font-size: 1rem;
            resize: vertical;
            font-family: 'Inter', sans-serif;
        }

        textarea:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        }

        /* Buttons */
        .btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95rem;
            margin-right: 10px;
            margin-bottom: 10px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            background: var(--accent-light);
        }

        .btn-secondary {
            background: white;
            color: var(--text);
            border: 1px solid var(--border);
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-secondary:hover {
            background: #f1f5f9;
        }

        /* Analysis panel */
        .analysis-panel {
            background: #f1f5f9;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 16px;
            margin: 20px 0;
            font-size: 0.95rem;
            color: var(--text-secondary);
            display: none;
        }

        .analysis-item {
            margin: 6px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 8px;
        }

        .badge-success { background: #ecfdf5; color: var(--success); }
        .badge-warning { background: #fff7ed; color: var(--warning); }
        .badge-danger { background: #fef2f2; color: var(--danger); }

        /* Progress bar */
        .progress-container {
            margin: 20px 0;
            display: none;
        }

        .progress-bar {
            height: 6px;
            background: var(--border);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: var(--accent);
            width: 0%;
            transition: width 0.4s ease;
        }

        .progress-message {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin: 5px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Output */
        .output {
            margin-top: 20px;
        }

        /* Status bar */
        .status-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: #f1f5f9;
            border-top: 1px solid var(--border);
            padding: 8px 30px;
            font-size: 0.85rem;
            color: var(--text-secondary);
            display: flex;
            justify-content: space-between;
            z-index: 100;
            align-items: center;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .toast {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg);
            color: var(--text);
            padding: 12px 24px;
            border: 1px solid var(--border);
            border-radius: 8px;
            box-shadow: var(--shadow);
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toast.show {
            opacity: 1;
        }
    </style>
</head>
<body>

    <!-- Sidebar -->
    <div class="sidebar">
        <div class="logo">
            <i data-lucide="sparkles"></i>
            RedactaPro Supremo
        </div>

        <div class="tool-section">
            <div class="tool-title">
                <i data-lucide="settings"></i>
                Modos
            </div>
            <button class="tool-btn" onclick="setMode('academico')">
                <i data-lucide="book-open"></i>
                üìö Acad√©mico
            </button>
            <button class="tool-btn" onclick="setMode('profesional')">
                <i data-lucide="briefcase"></i>
                üíº Profesional
            </button>
            <button class="tool-btn" onclick="setMode('estudiante')">
                <i data-lucide="graduation-cap"></i>
                üéì Estudiante
            </button>
        </div>

        <div class="tool-section">
            <div class="tool-title">
                <i data-lucide="wrench"></i>
                Herramientas
            </div>
            <button class="tool-btn" onclick="analizarLegibilidad()">
                <i data-lucide="bar-chart-2"></i>
                üìä Legibilidad
            </button>
            <button class="tool-btn" onclick="detectarPlagio()">
                <i data-lucide="shield-alert"></i>
                üîç Detector de Plagio
            </button>
            <button class="tool-btn" onclick="generarCita()">
                <i data-lucide="quote"></i>
                üîñ Generar Cita (APA)
            </button>
            <button class="tool-btn" onclick="modoRevision()">
                <i data-lucide="diff"></i>
                üîÑ Comparar Versiones
            </button>
        </div>

        <div class="tool-section">
            <div class="tool-title">
                <i data-lucide="download"></i>
                Exportar
            </div>
            <button class="tool-btn" onclick="exportarPDF()">
                <i data-lucide="file-text"></i>
                üìÑ Exportar PDF
            </button>
            <button class="tool-btn" onclick="exportarDOCX()">
                <i data-lucide="file-word"></i>
                üìÑ Exportar Word
            </button>
        </div>

        <div class="tool-section">
            <div class="tool-title">
                <i data-lucide="sliders-horizontal"></i>
                Configuraci√≥n
            </div>
            <label style="font-size: 0.85rem;">
                <i data-lucide="type"></i>
                Nivel de l√©xico:
            </label>
            <select id="nivelLexico" style="width: 100%; padding: 6px; margin: 6px 0; border: 1px solid var(--border); border-radius: 4px;">
                <option value="sencillo">Sencillo</option>
                <option value="equilibrado" selected>Equilibrado</option>
                <option value="avanzado">Avanzado</option>
            </select>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <h1>
            <i data-lucide="edit-3"></i>
            Editor Profesional Avanzado
        </h1>
        <p class="subtitle">Herramientas para escritura acad√©mica, profesional y t√©cnica</p>

        <div class="form-group">
            <label for="input">
                <i data-lucide="file-input"></i>
                Texto Original
            </label>
            <textarea id="input" placeholder="Pega tu texto aqu√≠..."></textarea>
        </div>

        <div>
            <button class="btn" onclick="humanizar()">
                <i data-lucide="sparkles"></i>
                Procesar Texto
            </button>
            <button class="btn btn-secondary" onclick="copiar()">
                <i data-lucide="copy"></i>
                Copiar
            </button>
            <button class="btn btn-secondary" onclick="limpiar()">
                <i data-lucide="trash-2"></i>
                Limpiar
            </button>
        </div>

        <!-- Progress -->
        <div class="progress-container" id="progressContainer">
            <p class="progress-message" id="progressMessage">
                <i data-lucide="loader"></i>
                Iniciando an√°lisis...
            </p>
            <div class="progress-bar">
                <div class="progress" id="progressBar"></div>
            </div>
        </div>

        <!-- Analysis -->
        <div class="analysis-panel" id="analysisPanel">
            <strong>üìä An√°lisis del Texto:</strong>
            <div class="analysis-item">
                <i data-lucide="type"></i>
                Palabras: <span id="wordCount">0</span>
            </div>
            <div class="analysis-item">
                <i data-lucide="message-square"></i>
                Frases: <span id="sentenceCount">0</span>
            </div>
            <div class="analysis-item">
                <i data-lucide="scale"></i>
                Legibilidad: <span id="legibility">-</span> <span id="legibilityBadge" class="badge"></span>
            </div>
            <div class="analysis-item">
                <i data-lucide="alert-triangle"></i>
                Plagio estimado: <span id="plagiarism">-</span> <span id="plagiarismBadge" class="badge"></span>
            </div>
        </div>

        <!-- Output -->
        <div class="output">
            <label for="output">
                <i data-lucide="file-output"></i>
                Texto Procesado
            </label>
            <textarea id="output" readonly placeholder="Aqu√≠ aparecer√° el resultado..."></textarea>
        </div>
    </div>

    <!-- Status Bar -->
    <div class="status-bar">
        <div class="status-item">
            <i data-lucide="circle"></i>
            <span>Listo para procesar</span>
        </div>
        <div class="status-item">
            <i data-lucide="settings"></i>
            <span id="status-mode">Modo: Estudiante</span>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast">
        <i data-lucide="check-circle"></i>
        <span id="toast-message">¬°Listo!</span>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/docx@7.11.0/build/index.browser.js"></script>
    <script>
        // Inicializar Lucide
        lucide.createIcons();

        // Estado
        let textoFinal = '';
        let modoActual = 'estudiante';
        const historialKey = 'rps_historial_v18';

        // Configuraci√≥n
        function setMode(mode) {
            modoActual = mode;
            document.getElementById('status-mode').textContent = `Modo: ${{
                academico: 'Acad√©mico',
                profesional: 'Profesional',
                estudiante: 'Estudiante'
            }[mode]}`;
            mostrarToast(`Modo: ${modoActual}`);
        }

        // Humanizar
        function humanizar() {
            const input = document.getElementById('input').value.trim();
            if (!input) {
                alert('Pega un texto primero');
                return;
            }

            const pc = document.getElementById('progressContainer');
            const pb = document.getElementById('progressBar');
            const pm = document.getElementById('progressMessage');
            pc.style.display = 'block';

            const steps = [
                { msg: "Limpiando texto...", delay: 300 },
                { msg: "Analizando estructura...", delay: 400 },
                { msg: "Detectando nivel de l√©xico...", delay: 300 },
                { msg: "Aplicando modo acad√©mico...", delay: 500 },
                { msg: "Optimizando legibilidad...", delay: 400 },
                { msg: "Finalizando...", delay: 300 }
            ];

            let current = 0;
            const total = steps.length;
            const increment = 100 / total;

            const interval = setInterval(() => {
                if (current < steps.length) {
                    const s = steps[current];
                    pm.textContent = s.msg;
                    pb.style.width = ((current + 1) * increment) + '%';
                    current++;
                } else {
                    clearInterval(interval);
                    textoFinal = aplicarModo(input);
                    document.getElementById('output').value = textoFinal;
                    pm.innerHTML = `<i data-lucide="check"></i> Procesado en modo ${modoActual}`;
                    lucide.createIcons(); // Reiniciar iconos
                    analizarLegibilidad();
                    mostrarToast('‚úÖ Procesado');
                }
            }, 300);
        }

        // Aplicar modo
        function aplicarModo(texto) {
            const nivel = document.getElementById('nivelLexico').value;
            let lines = texto.split('\n').filter(l => l.trim());
            let result = [];

            result.push(lines[0] + '.');
            result.push('');

            lines.slice(1).forEach(line => {
                if (nivel === 'sencillo') {
                    line = line.replace(/an√°lisis/gi, 'an√°lisis').replace(/evaluar/gi, 'ver');
                } else if (nivel === 'avanzado') {
                    line = line.replace(/ver/gi, 'evaluar').replace(/an√°lisis/gi, 'an√°lisis exhaustivo');
                }
                result.push(line);
                if (line.endsWith(':')) result.push('');
            });

            result.push('');
            result.push('En conclusi√≥n, este an√°lisis demuestra la importancia del tema tratado.');
            result.push('');
            result.push('Tu √©xito es mi mayor motivaci√≥n, mi vida üíñ');

            return result.join('\n');
        }

        // An√°lisis de legibilidad
        function analizarLegibilidad() {
            const input = document.getElementById('input').value.trim();
            if (!input) return;

            const words = input.split(/\s+/).length;
            const sentences = input.split(/[.!?]+/).length;
            const legibility = ((0.39 * words / sentences) + (11.8 * sentences / words) - 15.59).toFixed(1);

            document.getElementById('wordCount').textContent = words;
            document.getElementById('sentenceCount').textContent = sentences;
            document.getElementById('legibility').textContent = legibility;

            const badge = document.getElementById('legibilityBadge');
            if (legibility < 12) {
                badge.textContent = 'F√°cil';
                badge.className = 'badge badge-success';
            } else if (legibility < 14) {
                badge.textContent = 'Medio';
                badge.className = 'badge badge-warning';
            } else {
                badge.textContent = 'Dif√≠cil';
                badge.className = 'badge badge-danger';
            }

            document.getElementById('analysisPanel').style.display = 'block';
        }

        // Detector de plagio b√°sico
        function detectarPlagio() {
            const input = document.getElementById('input').value.toLowerCase();
            const frasesComunes = [
                'es importante destacar', 'en este contexto', 'a continuaci√≥n',
                'por lo tanto', 'como resultado', 'en conclusi√≥n'
            ];
            const encontradas = frasesComunes.filter(f => input.includes(f)).length;
            const porcentaje = Math.min(100, (encontradas / frasesComunes.length) * 100);

            document.getElementById('plagiarism').textContent = `${porcentaje}%`;
            const badge = document.getElementById('plagiarismBadge');
            if (porcentaje === 0) {
                badge.textContent = 'Bajo';
                badge.className = 'badge badge-success';
            } else if (porcentaje < 50) {
                badge.textContent = 'Medio';
                badge.className = 'badge badge-warning';
            } else {
                badge.textContent = 'Alto';
                badge.className = 'badge badge-danger';
            }

            document.getElementById('analysisPanel').style.display = 'block';
            mostrarToast(`Plagio estimado: ${porcentaje}%`);
        }

        // Generar cita APA
        function generarCita() {
            const cita = `Autor, A. A. (A√±o). T√≠tulo del trabajo. *Nombre de la Revista*, volumen(n√∫mero), p√°ginas. https://doi.org/xx.xxxx/xxxxxx`;
            document.getElementById('output').value = cita + '\n\n' + document.getElementById('output').value;
            mostrarToast('Cita APA generada');
        }

        // Modo revisi√≥n
        function modoRevision() {
            const input = document.getElementById('input').value;
            const output = document.getElementById('output').value;
            if (!input || !output) return;

            const diff = `--- Original\n+++ Procesado\n@@ -1,5 +1,5 @@\n${input.substring(0, 100)}...\n${output.substring(0, 100)}...`;
            document.getElementById('output').value = diff;
            mostrarToast('Modo revisi√≥n activado');
        }

        // Exportar PDF
        function exportarPDF() {
            if (!textoFinal) return;
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            doc.setFontSize(12);
            const lines = doc.splitTextToSize(textoFinal, 180);
            doc.text(lines, 15, 20);
            doc.save('redactapro-supremo.pdf');
        }

        // Exportar DOCX
        function exportarDOCX() {
            if (!textoFinal) return;
            const { Document, Packer, Paragraph, TextRun } = window.docx;

            const doc = new Document({
                sections: [{
                    properties: {},
                    children: [
                        new Paragraph({
                            children: [
                                new TextRun(textoFinal)
                            ]
                        })
                    ]
                }]
            });

            Packer.toBlob(doc).then(blob => {
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'redactapro-supremo.docx';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            });
        }

        // Copiar
        function copiar() {
            const out = document.getElementById('output');
            if (!out.value) return;
            out.select();
            document.execCommand('copy');
            mostrarToast('üìã Copiado');
        }

        // Limpiar
        function limpiar() {
            document.getElementById('input').value = '';
            document.getElementById('output').value = '';
            document.getElementById('progressContainer').style.display = 'none';
            document.getElementById('analysisPanel').style.display = 'none';
        }

        // Mostrar toast
        function mostrarToast(msg) {
            const t = document.getElementById('toast');
            const span = document.getElementById('toast-message');
            span.textContent = msg;
            t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 2000);
        }
    </script>
</body>
</html>
