<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduMed · Plataforma Avanzada de Educación Clínica</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #667eea;
            --primary-dark: #5a67d8;
            --secondary: #f56565;
            --success: #48bb78;
            --warning: #f6ad55;
            --danger: #e53e3e;
            --info: #3498db;
            --light: #f7fafc;
            --dark: #2d3748;
            --text: #4a5568;
            --text-light: #718096;
            --text-lighter: #a0aec0;
            --bg: #ffffff;
            --bg-light: #f7fafc;
            --bg-dark: #edf2f7;
            --border: #e2e8f0;
            --border-light: #cbd5e0;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --radius: 0.375rem;
            --radius-lg: 0.5rem;
            --radius-full: 9999px;
            --transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            --accent: #f97316;
            --accent-light: #fed7d7;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: var(--text);
            line-height: 1.6;
            transition: background 0.3s ease;
        }

        .container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 1200px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 90vh;
            position: relative;
        }

        .header {
            background: #4a5568;
            color: white;
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header-actions {
            display: flex;
            gap: 10px;
        }

        .theme-toggle {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .nav-container {
            display: flex;
            height: calc(100% - 60px);
        }

        .sidebar {
            width: 280px;
            background: var(--bg-light);
            padding: 20px;
            border-right: 1px solid var(--border);
            overflow-y: auto;
            transition: all 0.3s ease;
        }

        .sidebar-header {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--dark);
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
            font-weight: 600;
            font-size: 16px;
        }

        .cat-btn {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 16px;
            border: none;
            background: transparent;
            color: var(--text);
            cursor: pointer;
            border-radius: 10px;
            margin-bottom: 10px;
            font-size: 15px;
            font-weight: 500;
            transition: all 0.3s ease;
            width: 100%;
            text-align: left;
            position: relative;
            border: 1px solid transparent;
        }

        .cat-btn.active {
            background: var(--primary);
            color: white;
            box-shadow: 0 4px 6px rgba(102, 126, 234, 0.2);
            border-color: var(--primary);
        }

        .cat-btn:hover:not(.active) {
            background: var(--bg-dark);
            transform: translateX(4px);
            border-color: var(--border-light);
        }

        .cat-btn i {
            width: 22px;
            text-align: center;
            font-size: 16px;
        }

        .main-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            background: var(--bg-light);
        }

        .search-container {
            margin-bottom: 25px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 14px 18px;
            border: 1px solid var(--border);
            border-radius: 12px;
            font-size: 16px;
            outline: none;
            background: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            position: relative;
            z-index: 10;
        }

        .search-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1), 0 2px 4px rgba(0, 0, 0, 0.1);
            transform: translateY(-1px);
        }

        .search-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid var(--border);
            border-top: none;
            border-radius: 0 0 12px 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            max-height: 300px;
            overflow-y: auto;
            z-index: 9;
            display: none;
        }

        .suggestion-item {
            padding: 12px 16px;
            border-bottom: 1px solid var(--border-light);
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .suggestion-item:hover {
            background: var(--bg-dark);
        }

        .suggestion-item:last-child {
            border-bottom: none;
        }

        .suggestion-category {
            font-size: 12px;
            color: var(--text-light);
            background: var(--bg-light);
            padding: 4px 8px;
            border-radius: 6px;
            margin-right: 8px;
        }

        .card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
            margin-bottom: 25px;
            overflow: hidden;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            background: var(--bg-light);
            padding: 18px 24px;
            border-bottom: 1px solid var(--border);
        }

        .card-icon {
            color: var(--primary);
            font-size: 20px;
        }

        .card-title {
            font-size: 19px;
            font-weight: 600;
            color: var(--dark);
        }

        .card-body {
            padding: 24px;
        }

        .card-content {
            color: var(--text);
            line-height: 1.7;
            margin-bottom: 20px;
            font-size: 15px;
        }

        .steps-list {
            list-style: none;
            margin: 20px 0;
        }

        .steps-list li {
            padding: 10px 0;
            display: flex;
            align-items: flex-start;
            gap: 12px;
            border-bottom: 1px dashed var(--border-light);
            padding-bottom: 10px;
        }

        .steps-list li:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .steps-list li:before {
            content: "";
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: var(--primary);
            margin-top: 10px;
            flex-shrink: 0;
        }

        .notes {
            background-color: rgba(249, 115, 22, 0.1);
            border-left: 4px solid var(--accent);
            padding: 18px;
            border-radius: 0 10px 10px 0;
            margin: 20px 0;
            font-size: 14px;
            border: 1px solid rgba(249, 115, 22, 0.2);
        }

        .notes i {
            color: var(--accent);
            margin-right: 10px;
        }

        .visual-reference {
            margin: 20px 0;
            text-align: center;
        }

        .visual-reference img {
            max-width: 100%;
            border-radius: 10px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: zoom-in;
        }

        .visual-reference img:hover {
            transform: scale(1.02);
        }

        .visual-reference .caption {
            font-size: 14px;
            color: var(--text-light);
            margin-top: 10px;
            font-style: italic;
            text-align: center;
        }

        .source {
            font-size: 14px;
            color: var(--text-light);
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .source i {
            color: var(--primary);
        }

        .source a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
        }

        .source a:hover {
            text-decoration: underline;
        }

        .last-updated {
            font-size: 13px;
            color: var(--text-lighter);
            margin-left: 10px;
        }

        .tab-container {
            margin-top: 25px;
        }

        .tab-buttons {
            display: flex;
            border-bottom: 1px solid var(--border);
            margin-bottom: 25px;
            border-radius: 10px 10px 0 0;
            overflow: hidden;
        }

        .tab-btn {
            padding: 12px 20px;
            background: var(--bg-light);
            border: none;
            color: var(--text-light);
            cursor: pointer;
            font-size: 15px;
            font-weight: 500;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .tab-btn.active {
            color: var(--primary);
            background: white;
            border-bottom: 3px solid var(--primary);
            font-weight: 600;
        }

        .tab-btn:hover:not(.active) {
            color: var(--text);
            background: var(--bg-dark);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .disease-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
            margin-bottom: 25px;
            overflow: hidden;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .disease-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
        }

        .disease-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-light);
            padding: 18px 24px;
            border-bottom: 1px solid var(--border);
        }

        .disease-title {
            font-size: 19px;
            font-weight: 600;
            color: var(--dark);
        }

        .disease-prevalence {
            font-size: 14px;
            color: var(--text-light);
            background: var(--bg-dark);
            padding: 6px 10px;
            border-radius: 8px;
            font-weight: 500;
        }

        .disease-description {
            padding: 24px;
            color: var(--text);
            line-height: 1.7;
            font-size: 15px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 18px;
            margin: 20px 0;
        }

        .info-item {
            background: var(--bg-light);
            padding: 14px;
            border-radius: 10px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .info-item:hover {
            background: var(--bg-dark);
            border-color: var(--border-light);
        }

        .info-label {
            font-size: 14px;
            color: var(--text-light);
            margin-bottom: 6px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .info-label i {
            color: var(--primary);
            font-size: 14px;
        }

        .info-value {
            color: var(--dark);
            font-size: 15px;
            line-height: 1.5;
        }

        .image-gallery {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .image-item {
            flex: 1;
            min-width: 220px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .image-item:hover {
            transform: scale(1.03);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        }

        .image-item img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            border-radius: 10px;
        }

        .image-item .caption {
            padding: 8px;
            background: white;
            text-align: center;
            font-size: 13px;
            color: var(--text-light);
            border-top: 1px solid var(--border);
        }

        .resources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
        }

        .resource-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
            padding: 20px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
            height: 100%;
        }

        .resource-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
        }

        .resource-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .resource-title i {
            color: var(--primary);
        }

        .resource-description {
            color: var(--text);
            font-size: 14px;
            margin-bottom: 12px;
            line-height: 1.6;
        }

        .resource-category {
            font-size: 12px;
            color: var(--text-light);
            background: var(--bg-dark);
            padding: 5px 10px;
            border-radius: 8px;
            display: inline-block;
            margin-bottom: 10px;
        }

        .resource-link {
            display: inline-block;
            padding: 10px 16px;
            background: var(--primary);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            text-align: center;
            width: 100%;
        }

        .resource-link:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
        }

        .progress-container {
            margin: 25px 0;
        }

        .quiz-container {
            margin: 25px 0;
        }

        .quiz-question {
            font-size: 16px;
            font-weight: 500;
            color: var(--dark);
            margin-bottom: 18px;
            line-height: 1.5;
        }

        .quiz-options {
            list-style: none;
        }

        .quiz-option {
            padding: 12px 18px;
            background: var(--bg-light);
            border: 1px solid var(--border);
            border-radius: 10px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 15px;
        }

        .quiz-option:hover {
            background: var(--bg-dark);
            border-color: var(--primary);
            transform: translateX(6px);
        }

        .quiz-option.selected {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            font-weight: 500;
        }

        .quiz-feedback {
            margin: 20px 0;
            padding: 18px;
            border-radius: 10px;
            font-size: 15px;
            line-height: 1.5;
        }

        .quiz-feedback.correct {
            background: rgba(72, 187, 120, 0.1);
            border: 1px solid var(--success);
            color: #166534;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .quiz-feedback.incorrect {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid var(--danger);
            color: #991b1b;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .quiz-feedback i {
            font-size: 18px;
            flex-shrink: 0;
        }

        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 18px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 500;
            transition: all 0.3s ease;
            min-width: 120px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: var(--bg-dark);
            color: var(--text);
        }

        .btn-secondary:hover {
            background: var(--border-light);
            transform: translateY(-1px);
        }

        .vitals-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 18px;
            margin: 25px 0;
        }

        .vital-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            border: 1px solid var(--border);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        .vital-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }

        .vital-label {
            font-size: 15px;
            color: var(--text-light);
            margin-bottom: 10px;
            font-weight: 500;
        }

        .vital-value {
            font-size: 28px;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 4px;
        }

        .vital-unit {
            font-size: 14px;
            color: var(--text-light);
        }

        .normal-range {
            font-size: 13px;
            color: var(--text-lighter);
            margin-top: 6px;
            padding-top: 6px;
            border-top: 1px dashed var(--border);
        }

        .controls {
            margin: 20px 0;
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .control-btn {
            padding: 10px 16px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 18px 24px;
            background: var(--primary);
            color: white;
            border-radius: 12px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            transform: translateY(-100px);
            opacity: 0;
            transition: all 0.4s ease;
            font-weight: 500;
            min-width: 280px;
            text-align: center;
        }

        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }

        .notification.success {
            background: var(--success);
        }

        .notification.error {
            background: var(--danger);
        }

        .notification.warning {
            background: var(--warning);
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-light);
        }

        .empty-state i {
            font-size: 48px;
            color: var(--border);
            margin-bottom: 16px;
        }

        .empty-state h3 {
            color: var(--text);
            margin-bottom: 8px;
            font-size: 20px;
        }

        .empty-state p {
            color: var(--text-light);
            font-size: 15px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: var(--text-light);
        }

        .loading i {
            font-size: 24px;
            color: var(--primary);
            margin-right: 8px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .page-header {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }

        .page-title {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--dark);
            margin-bottom: 8px;
            font-size: 22px;
            font-weight: 600;
        }

        .page-description {
            color: var(--text-light);
            font-size: 15px;
        }

        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border);
            margin-bottom: 25px;
        }

        .tab {
            padding: 12px 20px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 500;
            color: var(--text-light);
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .tab.active {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
            font-weight: 600;
        }

        .tab:hover:not(.active) {
            color: var(--text);
            background: var(--bg-dark);
        }

        .material-tag {
            display: inline-block;
            background: var(--bg-dark);
            color: var(--text);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 13px;
            margin: 4px;
            border: 1px solid var(--border);
        }

        .procedure-detail {
            background: white;
            border-radius: 16px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
            margin-bottom: 25px;
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .procedure-header {
            display: flex;
            align-items: center;
            gap: 12px;
            background: var(--bg-light);
            padding: 18px 24px;
            border-bottom: 1px solid var(--border);
            position: relative;
        }

        .procedure-icon {
            color: var(--primary);
            font-size: 20px;
        }

        .procedure-title {
            font-size: 19px;
            font-weight: 600;
            color: var(--dark);
        }

        .procedure-summary {
            padding: 24px;
            color: var(--text);
            line-height: 1.7;
            font-size: 15px;
            border-bottom: 1px solid var(--border);
        }

        .section-title {
            font-size: 17px;
            font-weight: 600;
            color: var(--dark);
            margin: 20px 0 15px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .materials-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 15px 0;
        }

        .protocol-container {
            background: white;
            border-radius: 16px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
            margin-bottom: 25px;
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .protocol-header {
            display: flex;
            align-items: center;
            gap: 12px;
            background: var(--bg-light);
            padding: 18px 24px;
            border-bottom: 1px solid var(--border);
        }

        .protocol-icon {
            color: var(--primary);
            font-size: 20px;
        }

        .protocol-title {
            font-size: 19px;
            font-weight: 600;
            color: var(--dark);
        }

        .protocol-summary {
            padding: 16px 24px;
            background: var(--bg-light);
            color: var(--text-light);
            font-size: 14px;
            border-bottom: 1px solid var(--border);
        }

        .protocol-steps {
            padding: 24px;
        }

        .protocol-step {
            margin-bottom: 15px;
            padding-left: 20px;
            position: relative;
        }

        .protocol-step:before {
            content: "";
            position: absolute;
            left: 0;
            top: 8px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: var(--primary);
        }

        .external-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }

        .external-links a {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: var(--bg-light);
            border-radius: 10px;
            text-decoration: none;
            color: var(--text);
            transition: all 0.3s ease;
            border: 1px solid var(--border);
        }

        .external-links a:hover {
            background: var(--bg-dark);
            transform: translateX(6px);
            border-color: var(--primary);
        }

        .external-links i {
            color: var(--primary);
            font-size: 18px;
        }

        .video-resources {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }

        .video-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .video-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        }

        .video-thumbnail {
            width: 100%;
            height: 180px;
            object-fit: cover;
        }

        .video-info {
            padding: 16px;
        }

        .video-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 8px;
            font-size: 15px;
        }

        .video-meta {
            display: flex;
            justify-content: space-between;
            color: var(--text-light);
            font-size: 13px;
        }

        .video-meta div {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .disease-symptoms, .disease-treatment, .disease-diagnosis {
            margin: 15px 0;
            padding: 15px;
            background: var(--bg-light);
            border-radius: 10px;
            border: 1px solid var(--border);
        }

        .disease-symptoms ul, .disease-treatment ul, .disease-diagnosis ul {
            margin: 10px 0;
            padding-left: 20px;
        }

        .disease-symptoms li, .disease-treatment li, .disease-diagnosis li {
            margin: 8px 0;
        }

        .disease-symptoms i, .disease-treatment i, .disease-diagnosis i {
            color: var(--primary);
            margin-right: 8px;
        }

        /* Nuevos estilos para mejoras */
        .bookmark-btn {
            background: transparent;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s ease;
            position: absolute;
            right: 20px;
            top: 20px;
        }

        .bookmark-btn.active {
            color: var(--warning);
        }

        .bookmark-btn:hover {
            transform: scale(1.1);
        }

        .history-item {
            padding: 10px 15px;
            border-bottom: 1px solid var(--border-light);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .history-item:hover {
            background: var(--bg-dark);
        }

        .filter-bar {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            background: var(--bg-light);
            border: 1px solid var(--border);
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .filter-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .favorite-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--warning);
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        @media (max-width: 1024px) {
            .container {
                max-width: 95%;
                height: 95vh;
            }
            
            .sidebar {
                width: 240px;
            }
        }

        @media (max-width: 768px) {
            .container {
                max-width: 100%;
                height: 100vh;
                border-radius: 0;
            }
            
            .nav-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid var(--border);
                height: auto;
                max-height: 30vh;
                overflow-y: auto;
            }
            
            .main-content {
                max-height: calc(100vh - 200px);
                padding: 20px;
            }
            
            .header h1 {
                font-size: 20px;
            }
            
            .card {
                border-radius: 12px;
            }
            
            .card-header {
                padding: 15px 20px;
            }
            
            .card-body {
                padding: 20px;
            }
            
            .resources-grid, .video-resources, .external-links {
                grid-template-columns: 1fr;
            }
            
            .vitals-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .header {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 18px;
            }
            
            .sidebar-header {
                font-size: 16px;
            }
            
            .cat-btn {
                padding: 12px 14px;
                font-size: 14px;
            }
            
            .main-content {
                padding: 15px;
            }
            
            .card-header {
                padding: 12px 16px;
            }
            
            .card-body {
                padding: 16px;
            }
            
            .search-input {
                padding: 12px 16px;
                font-size: 15px;
            }
            
            .notification {
                right: 10px;
                left: 10px;
                min-width: auto;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-heartbeat"></i> EduMed</h1>
            <div class="header-actions">
                <button class="theme-toggle" id="themeToggle"><i class="fas fa-palette"></i></button>
            </div>
        </div>
        
        <div class="nav-container">
            <div class="sidebar">
                <div class="sidebar-header">
                    <i class="fas fa-th-large"></i>
                    <h3>Funcionalidades</h3>
                </div>
                <button class="cat-btn active" data-cat="emergencias">
                    <i class="fas fa-ambulance"></i>
                    <span>Emergencias Médicas</span>
                </button>
                <button class="cat-btn" data-cat="farmacologia">
                    <i class="fas fa-pills"></i>
                    <span>Farmacología</span>
                </button>
                <button class="cat-btn" data-cat="procedimientos">
                    <i class="fas fa-procedures"></i>
                    <span>Procedimientos</span>
                </button>
                <button class="cat-btn" data-cat="enfermedades">
                    <i class="fas fa-disease"></i>
                    <span>Enfermedades</span>
                </button>
                <button class="cat-btn" data-cat="nutricion">
                    <i class="fas fa-apple-alt"></i>
                    <span>Nutrición</span>
                </button>
                <button class="cat-btn" data-cat="infecciones">
                    <i class="fas fa-virus"></i>
                    <span>Control de Infecciones</span>
                </button>
                <button class="cat-btn" data-cat="movilizacion">
                    <i class="fas fa-walking"></i>
                    <span>Movilización</span>
                </button>
                <button class="cat-btn" data-cat="rcp">
                    <i class="fas fa-heart-pulse"></i>
                    <span>RCP</span>
                </button>
                <button class="cat-btn" data-cat="recursos">
                    <i class="fas fa-book-medical"></i>
                    <span>Recursos</span>
                </button>
                <button class="cat-btn" data-cat="simulador">
                    <i class="fas fa-vr-cardboard"></i>
                    <span>Simulador</span>
                </button>
                <button class="cat-btn" data-cat="evaluacion">
                    <i class="fas fa-clipboard-check"></i>
                    <span>Evaluación</span>
                </button>
                <button class="cat-btn" data-cat="reumatologia">
                    <i class="fas fa-bone"></i>
                    <span>Reumatología</span>
                </button>
                <button class="cat-btn" data-cat="gastroenterologia">
                    <i class="fas fa-stomach"></i>
                    <span>Gastroenterología</span>
                </button>
                <button class="cat-btn" data-cat="nefrologia">
                    <i class="fas fa-kidneys"></i>
                    <span>Nefrología</span>
                </button>
                <button class="cat-btn" data-cat="endocrinologia">
                    <i class="fas fa-brain"></i>
                    <span>Endocrinología</span>
                </button>
            </div>
            
            <div class="main-content">
                <div class="search-container">
                    <input type="text" class="search-input" id="searchInput" placeholder="Buscar en la aplicación...">
                    <div class="search-suggestions" id="searchSuggestions"></div>
                </div>
                
                <div id="mainContent">
                    <!-- El contenido se cargará aquí dinámicamente -->
                </div>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification">
        Cambios guardados correctamente
    </div>

    <script>
        // Datos médicos completos
        const medicalData = {
            emergencias: {
                title: "Emergencias Médicas",
                icon: "fa-ambulance",
                description: "Manejo de situaciones críticas y emergencias médicas",
                procedures: [
                    {
                        id: "iam",
                        title: "Infarto Agudo de Miocardio",
                        icon: "fa-heart-pulse",
                        summary: "Manejo agudo del IAM con intervención coronaria percutánea de urgencia.",
                        materials: ["ECG", "Aspirina", "Clopidogrel", "Heparina", "Morfina", "Oxígeno"],
                        steps: [
                            "Activación del código infarto",
                            "ECG dentro de los primeros 10 minutos",
                            "Confirmación diagnóstica con elevación del ST",
                            "Establecer acceso venoso periférico",
                            "Administrar aspirina 162-325 mg masticable",
                            "Administrar clopidogrel 600 mg o ticagrelor 180 mg",
                            "Administrar heparina no fraccionada",
                            "Administrar analgesia (morfina)",
                            "Oxigenoterapia si saturación <90%",
                            "Intervención coronaria percutánea de urgencia"
                        ],
                        notes: "El tiempo es músculo. El objetivo es puerta-balón <90 minutos.",
                        visualReferences: [
                            {
                                url: "https://upload.wikimedia.org/wikipedia/commons/thumb/7/72/STEMI_electrocardiogram.jpg/800px-STEMI_electrocardiogram.jpg",
                                title: "ECG de IAMCEST",
                                description: "Elevación del segmento ST en derivaciones precordiales"
                            }
                        ],
                        source: {
                            name: "AHA Guidelines",
                            url: "https://www.heart.org/en/guidelines"
                        },
                        lastUpdated: "2023-09-15"
                    },
                    {
                        id: "sepsis",
                        title: "Sepsis y Shock Séptico",
                        icon: "fa-bacteria",
                        summary: "Reconocimiento y manejo temprano de la sepsis para reducir la mortalidad.",
                        materials: ["Hemocultivos", "Antibióticos", "Fluidos", "Vasopresores", "Equipo de soporte"],
                        steps: [
                            "Identificación de criterios de SIRS",
                            "Obtención de hemocultivos",
                            "Administración de antibióticos empíricos en la primera hora",
                            "Reanimación con fluidos cristaloides (30 ml/kg)",
                            "Uso de vasopresores si persiste hipotensión",
                            "Control de la fuente de infección",
                            "Soporte de órganos fallo"
                        ],
                        notes: "Mortalidad 15-30%. Mejora con intervención temprana (<1 hora).",
                        visualReferences: [
                            {
                                url: "https://upload.wikimedia.org/wikipedia/commons/thumb/5/5a/Sepsis_pathophysiology.png/800px-Sepsis_pathophysiology.png",
                                title: "Fisiopatología de la Sepsis",
                                description: "Respuesta sistémica a la infección"
                            }
                        ],
                        source: {
                            name: "Surviving Sepsis Campaign",
                            url: "https://www.sccm.org/survivingsepsiscampaign"
                        },
                        lastUpdated: "2023-08-20"
                    }
                ],
                diseases: [
                    {
                        id: "shock",
                        name: "Shock Séptico",
                        prevalence: "30 millones/año",
                        description: "Estado de hipoperfusión sistémica causado por una respuesta inflamatoria descontrolada a una infección.",
                        symptoms: ["Hipotensión", "Taquicardia", "Fiebre o hipotermia", "Taquipnea", "Alteración del estado mental"],
                        diagnosis: ["Criterios de SIRS", "Presencia de infección", "Hipoperfusión tisular", "Lactato elevado"],
                        treatment: ["Antibióticos empíricos", "Reanimación con fluidos", "Vasopresores", "Soporte de órganos", "Control de fuente infecciosa"],
                        complications: ["Insuficiencia multiorgánica", "Coagulopatía", "Necrosis tisular", "Muerte"],
                        prognosis: "Mortalidad 30-50%. Mejora significativa con intervención temprana (<1 hora).",
                        images: ["https://upload.wikimedia.org/wikipedia/commons/thumb/5/5a/Sepsis_pathophysiology.png/800px-Sepsis_pathophysiology.png"],
                        sources: [
                            {
                                name: "Surviving Sepsis Campaign",
                                url: "https://www.sccm.org/survivingsepsiscampaign"
                            }
                        ],
                        lastUpdated: "2023-10-15"
                    }
                ],
                protocols: [
                    {
                        id: "sepsis_bundle",
                        name: "Bundle de Sepsis 1 hora",
                        level: "Grado 1A",
                        summary: "Conjunto de intervenciones que deben completarse en la primera hora tras el diagnóstico de sepsis.",
                        steps: [
                            "Medición de lactato",
                            "Hemocultivos antes de antibióticos",
                            "Antibióticos de amplio espectro",
                            "Reanimación con fluidos 30ml/kg si hipotensión o lactato ≥4mmol/L",
                            "Vasopresores si persiste hipotensión tras fluidos"
                        ],
                        source: {
                            name: "Surviving Sepsis Campaign",
                            url: "https://www.sccm.org/survivingsepsiscampaign"
                        },
                        lastUpdated: "2023-09-20"
                    }
                ],
                resources: [
                    {
                        title: "AHA Guidelines",
                        description: "Guías para reanimación cardiopulmonar",
                        url: "https://www.heart.org/en/guidelines",
                        icon: "fa-heart-pulse",
                        category: "Emergencias"
                    },
                    {
                        title: "Surviving Sepsis Campaign",
                        description: "Guías para el manejo de la sepsis",
                        url: "https://www.sccm.org/survivingsepsiscampaign",
                        icon: "fa-bacteria",
                        category: "Emergencias"
                    }
                ]
            },
            farmacologia: {
                title: "Farmacología",
                icon: "fa-pills",
                description: "Información sobre medicamentos y sus usos clínico",
                medications: [
                    {
                        id: "aspirin",
                        name: "Aspirina",
                        class: "Antiagregante plaquetario",
                        indications: ["IAM agudo", "Accidente cerebrovascular isquémico", "Prevención secundaria cardiovascular"],
                        dosage: "75-100 mg/día (mantenimiento), 162-325 mg (carga)",
                        contraindications: ["Alergia a AINEs", "Úlcera péptica activa", "Hemorragia activa"],
                        sideEffects: ["Hemorragia gastrointestinal", "Acufeno", "Asma inducida por AINEs"],
                        pharmacokinetics: "Absorción rápida en estómago e intestino. Metabolismo hepático.",
                        warnings: "Riesgo de síndrome de Reye en niños. Interacción con anticoagulantes.",
                        storage: "Conservar a temperatura ambiente, protegido de la humedad.",
                        interactions: [
                            {
                                drug: "Warfarina",
                                severity: "Severa",
                                mechanism: "Aumento del riesgo de hemorragia",
                                recommendation: "Evitar combinación si es posible. Monitorear INR de cerca."
                            }
                        ],
                        images: ["https://upload.wikimedia.org/wikipedia/commons/thumb/5/5d/Aspirin_200mg.jpg/800px-Aspirin_200mg.jpg"],
                        sources: [
                            {
                                name: "FDA",
                                url: "https://www.fda.gov/drugs"
                            }
                        ],
                        lastUpdated: "2023-09-01"
                    },
                    {
                        id: "metformin",
                        name: "Metformina",
                        class: "Biguanida",
                        indications: ["Diabetes mellitus tipo 2", "Síndrome de ovario poliquístico"],
                        dosage: "500-2000 mg/día en dosis divididas. Dosis máxima 2550 mg/día.",
                        contraindications: ["Insuficiencia renal (TFG <30 ml/min)", "Acidosis metabólica", "Shock"],
                        sideEffects: ["Náuseas, diarrea", "Dolor abdominal", "Deficiencia de vitamina B12 con uso prolongado"],
                        pharmacokinetics: "No se metaboliza. Excreción renal. Vida media 6.2 h.",
                        warnings: "Riesgo de acidosis láctica (raro pero grave).",
                        storage: "Conservar a temperatura ambiente, protegido de la humedad.",
                        interactions: [
                            {
                                drug: "Contraste yodado",
                                severity: "Severa",
                                mechanism: "Riesgo de acidosis láctica",
                                recommendation: "Suspender metformina antes del procedimiento."
                            }
                        ],
                        images: ["https://upload.wikimedia.org.wikimedia.org/wikipedia/commons/thumb/3/3e/Metformin_500mg_tablets.jpg/800px-Metformin_500mg_tablets.jpg"],
                        sources: [
                            {
                                name: "FDA",
                                url: "https://www.fda.gov/drugs"
                            }
                        ],
                        lastUpdated: "2023-08-15"
                    }
                ],
                resources: [
                    {
                        title: "Micromedex",
                        description: "Base de datos de farmacología clínica",
                        url: "https://www.micromedexsolutions.com",
                        icon: "fa-book-medical",
                        category: "Referencia"
                    },
                    {
                        title: "Lexicomp",
                        description: "Información sobre medicamentos y dosificación",
                        url: "https://www.lexicomp.com",
                        icon: "fa-book-medical",
                        category: "Referencia"
                    }
                ]
            },
            procedimientos: {
                title: "Procedimientos",
                icon: "fa-procedures",
                description: "Guías para procedimientos médicos comunes",
                procedures: [
                    {
                        id: "lumbar_puncture",
                        title: "Punción Lumbar",
                        icon: "fa-bed",
                        summary: "Procedimiento para obtener líquido cefalorraquídeo.",
                        materials: ["Juego de punción lumbar", "Tubos para muestras", "Equipo estéril", "Anestesia local"],
                        steps: [
                            "Posición adecuada (lateral fetal o sentado)",
                            "Identificación del espacio intervertebral",
                            "Anestesia local",
                            "Inserción de la aguja",
                            "Recolección de muestras",
                            "Retiro de la aguja y apósito"
                        ],
                        notes: "Indicado para diagnóstico de meningitis, hemorragia subaracnoidea, entre otros.",
                        visualReferences: [
                            {
                                url: "https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Lumbar_puncture_position.jpg/800px-Lumbar_puncture_position.jpg",
                                title: "Posición para Punción Lumbar",
                                description: "Posición lateral fetal con rodillas hacia el pecho"
                            }
                        ],
                        source: {
                            name: "UpToDate",
                            url: "https://www.uptodate.com"
                        },
                        lastUpdated: "2023-09-10"
                    },
                    {
                        id: "intubation",
                        title: "Intubación Orotraqueal",
                        icon: "fa-user-md",
                        summary: "Procedimiento para establecer vía aérea definitiva.",
                        materials: ["Laringoscopio", "Tubo endotraqueal", "Estilete", "Ambú", "Equipo de succión"],
                        steps: [
                            "Preoxigenación con mascarilla de reservorio",
                            "Posición adecuada (posición de olfateo)",
                            "Apertura de la vía aérea (maniobra de Sellick si indicado)",
                            "Visualización de cuerdas vocales con laringoscopio",
                            "Introducción del tubo endotraqueal",
                            "Confirmación de colocación correcta",
                            "Fijación del tubo"
                        ],
                        notes: "Complicaciones: trauma dental, intubación esofágica, hipoxemia.",
                        visualReferences: [
                            {
                                url: "https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Endotracheal_intubation.jpg/800px-Endotracheal_intubation.jpg",
                                title: "Intubación Orotraqueal",
                                description: "Visualización de cuerdas vocales durante intubación"
                            }
                        ],
                        source: {
                            name: "Difficult Airway Society",
                            url: "https://www.das.uk.com"
                        },
                        lastUpdated: "2023-07-05"
                    }
                ],
                resources: [
                    {
                        title: "UpToDate",
                        description: "Base de datos clínica actualizada",
                        url: "https://www.uptodate.com",
                        icon: "fa-book-medical",
                        category: "Referencia"
                    },
                    {
                        title: "NEJM Procedures",
                        description: "Videos y guías de procedimientos médicos",
                        url: "https://www.nejm.org/medical-articles/procedures",
                        icon: "fa-video",
                        category: "Videos"
                    }
                ]
            },
            enfermedades: {
                title: "Enfermedades",
                icon: "fa-disease",
                description: "Información sobre enfermedades comunes y raras",
                diseases: [
                    {
                        id: "diabetes",
                        name: "Diabetes Mellitus",
                        prevalence: "9.3% global",
                        description: "Grupo de enfermedades metabólicas caracterizadas por hiperglucemia crónica debido a defectos en la secreción de insulina, acción de insulina o ambos.",
                        symptoms: ["Poliuria", "Polidipsia", "Pérdida de peso", "Fatiga", "Visión borrosa"],
                        diagnosis: ["Glucemia en ayunas ≥126 mg/dL", "HbA1c ≥6.5%", "Glucemia al azar ≥200 mg/dL con síntomas"],
                        treatment: ["Modificación de estilo de vida", "Metformina", "Insulina", "Otros hipoglucemiantes orales", "Educación del paciente"],
                        complications: ["Retinopatía diabética", "Nefropatía diabética", "Neuropatía diabética", "Enfermedad cardiovascular", "Pie diabético"],
                        prognosis: "Variable según control glucémico. Mejora con intervención temprana y control adecuado.",
                        images: ["https://upload.wikimedia.org/wikipedia/commons/thumb/9/90/Diabetes_symptoms.png/800px-Diabetes_symptoms.png"],
                        sources: [
                            {
                                name: "WHO",
                                url: "https://www.who.int/health-topics/diabetes"
                            }
                        ],
                        lastUpdated: "2023-09-20"
                    },
                    {
                        id: "tb",
                        name: "Tuberculosis",
                        prevalence: "10 millones/año",
                        description: "Enfermedad infecciosa causada por Mycobacterium tuberculosis que afecta principalmente los pulmones.",
                        symptoms: ["Tos crónica (>2 semanas)", "Hemoptisis", "Fiebre vespertina", "Sudores nocturnos", "Pérdida de peso"],
                        diagnosis: ["Radiografía de tórax", "Baciloscopia", "Cultivo", "Prueba molecular (Xpert MTB/RIF)", "Prueba de la tuberculina o IGRA"],
                        treatment: ["Esquema estándar 2HRZE/4HR", "Tratamiento supervisado", "Manejo de efectos adversos", "Terapia para TB resistente"],
                        complications: ["TB multidrogoresistente", "Diseminación miliar", "Meningitis tuberculosa", "Deterioro pulmonar crónico"],
                        prognosis: "Buena con tratamiento adecuado y completo. Mortalidad <5% con tratamiento.",
                        images: [
                            "https://upload.wikimedia.org/wikipedia/commons/thumb/5/5a/Tuberculosis_radiograph.jpg/800px-Tuberculosis_radiograph.jpg"
                        ],
                        sources: [
                            {
                                name: "WHO",
                                url: "https://www.who.int/teams/global-tuberculosis-programme"
                            }
                        ],
                        lastUpdated: "2023-08-30"
                    }
                ],
                resources: [
                    {
                        title: "Orphanet",
                        description: "Información sobre enfermedades raras",
                        url: "https://www.orpha.net",
                        icon: "fa-book-medical",
                        category: "Enfermedades Raras"
                    },
                    {
                        title: "Genetics Home Reference",
                        description: "Información sobre condiciones genéticas",
                        url: "https://ghr.nlm.nih.gov",
                        icon: "fa-dna",
                        category: "Genética"
                    }
                ]
            },
            nutricion: {
                title: "Nutrición",
                icon: "fa-apple-alt",
                description: "Técnicas y recomendaciones para el manejo nutricional",
                procedures: [
                    {
                        id: "enteral",
                        title: "Nutrición Enteral",
                        icon: "fa-utensils",
                        summary: "Administración de nutrientes a través del tracto gastrointestinal.",
                        materials: ["Sonda nasogástrica", "Sonda nasoyeyunal", "Gastrostomía", "Yeyunostomía"],
                        steps: [
                            "Evaluación del paciente",
                            "Elección del tipo de sonda",
                            "Colocación de la sonda",
                            "Confirmación de colocación",
                            "Inicio de la nutrición",
                            "Monitoreo y ajustes"
                        ],
                        notes: "Evaluar riesgo de aspiración. Iniciar lentamente. Monitorear tolerancia.",
                        source: {
                            name: "ESPEN Guidelines",
                            url: "https://www.espen.org"
                        },
                        lastUpdated: "2023-08-25"
                    }
                ],
                diseases: [
                    {
                        id: "malnutrition",
                        name: "Desnutrición",
                        prevalence: "820 millones personas",
                        description: "Condición que ocurre cuando el cuerpo no obtiene suficientes nutrientes para mantener tejidos y funciones corporales adecuadas.",
                        symptoms: ["Pérdida de peso", "Debilidad", "Edema", "Alteraciones cutáneas", "Retraso en la cicatrización"],
                        diagnosis: ["Índice de masa corporal <18.5", "Pérdida de peso >10% en 6 meses", "Albumina <3.5 g/dL", "Escalas de evaluación nutricional"],
                        treatment: ["Nutrición oral", "Suplementos", "Nutrición enteral", "Nutrición parenteral", "Tratamiento de la causa subyacente"],
                        complications: ["Infecciones", "Retraso en la cicatrización", "Déficit cognitivo", "Mortalidad aumentada"],
                        prognosis: "Mejora con intervención nutricional oportuna.",
                        images: ["https://upload.wikimedia.org/wikipedia/commons/thumb/8/8c/Malnutrition_child.jpg/800px-Malnutrition_child.jpg"],
                        sources: [
                            {
                                name: "ESPEN",
                                url: "https://www.espen.org/guidelines"
                            }
                        ],
                        lastUpdated: "2023-07-15"
                    }
                ],
                resources: [
                    {
                        title: "ESPEN Guidelines",
                        description: "Guías de la Sociedad Europea de Nutrición Clínica y Metabolismo",
                        url: "https://www.espen.org/guidelines",
                        icon: "fa-book-medical",
                        category: "Referencia"
                    },
                    {
                        title: "ASPEN Resources",
                        description: "Recursos de la Sociedad Americana de Nutrición Parenteral y Enteral",
                        url: "https://www.nutritioncare.org",
                        icon: "fa-apple-alt",
                        category: "Educación"
                    }
                ]
            },
            // Otras categorías con datos básicos...
            recursos: {
                title: "Recursos Médicos",
                icon: "fa-book-medical",
                description: "Recursos de referencia para profesionales de la salud",
                resources: [
                    {
                        title: "GINA Guidelines",
                        description: "Guías globales para el manejo del asma",
                        url: "https://ginasthma.org",
                        icon: "fa-book-medical",
                        category: "Referencia"
                    },
                    {
                        title: "GOLD Guidelines",
                        description: "Guías para el manejo de la EPOC",
                        url: "https://goldcopd.org",
                        icon: "fa-book-medical",
                        category: "Referencia"
                    },
                    {
                        title: "CDC Guidelines",
                        description: "Guías para el control de infecciones",
                        url: "https://www.cdc.gov/infectioncontrol/guidelines",
                        icon: "fa-virus",
                        category: "Control de Infecciones"
                    }
                ],
                externalLinks: [
                    {
                        title: "PubMed",
                        description: "Base de datos de literatura biomédica",
                        url: "https://pubmed.ncbi.nlm.nih.gov",
                        icon: "fa-search",
                        category: "Investigación"
                    },
                    {
                        title: "UpToDate",
                        description: "Recurso clínico basado en evidencia",
                        url: "https://www.uptodate.com",
                        icon: "fa-book-medical",
                        category: "Clínico"
                    }
                ],
                videos: [
                    {
                        title: "Atlas Dermatológico",
                        description: "Colección de imágenes de condiciones dermatológicas",
                        thumbnail: "https://via.placeholder.com/300x180/667eea/ffffff?text=Atlas+Dermatológico",
                        url: "https://dermatlas.com",
                        views: 15600,
                        rating: 4.9,
                        published: "2023-08-12"
                    },
                    {
                        title: "ECG Interpretation",
                        description: "Guía para interpretar electrocardiogramas",
                        thumbnail: "https://via.placeholder.com/300x180/f56565/ffffff?text=ECG+Interpretation",
                        url: "https://ecglibrary.com",
                        views: 8900,
                        rating: 4.8,
                        published: "2023-07-15"
                    }
                ]
            },
            simulador: {
                title: "Simulador Clínico",
                icon: "fa-vr-cardboard",
                description: "Simulador interactivo de signos vitales y escenarios clínicos",
                vitals: [
                    { id: "heartRate", label: "Frecuencia Cardíaca", value: 75, unit: "lpm", normalRange: [60, 100] },
                    { id: "bloodPressure", label: "Presión Arterial", value: "120/80", unit: "mmHg", normalRange: [90, 140] },
                    { id: "oxygenSaturation", label: "Sat. Oxígeno", value: 98, unit: "%", normalRange: [95, 100] },
                    { id: "respiratoryRate", label: "Frecuencia Respiratoria", value: 16, unit: "rpm", normalRange: [12, 20] },
                    { id: "temperature", label: "Temperatura", value: 36.8, unit: "°C", normalRange: [36.1, 37.2] },
                    { id: "glucose", label: "Glucemia", value: 95, unit: "mg/dL", normalRange: [70, 100] }
                ],
                scenarios: [
                    {
                        id: "shock",
                        name: "Shock Séptico",
                        description: "Paciente con sepsis progresiva",
                        changes: {
                            heartRate: { value: 125, color: "red" },
                            bloodPressure: { value: "85/50", color: "red" },
                            oxygenSaturation: { value: 88, color: "orange" },
                            respiratoryRate: { value: 28, color: "orange" },
                            temperature: { value: 39.2, color: "red" },
                            glucose: { value: 180, color: "orange" }
                        }
                    },
                    {
                        id: "hypoglycemia",
                        name: "Hipoglucemia",
                        description: "Paciente diabético con hipoglucemia",
                        changes: {
                            heartRate: { value: 110, color: "orange" },
                            bloodPressure: { value: "110/70", color: "green" },
                            oxygenSaturation: { value: 97, color: "green" },
                            respiratoryRate: { value: 18, color: "green" },
                            temperature: { value: 36.5, color: "green" },
                            glucose: { value: 45, color: "red" }
                        }
                    }
                ],
                resources: [
                    {
                        title: "Simulador de ECG",
                        description: "Simulador interactivo de electrocardiogramas",
                        url: "https://ecgsim.com",
                        icon: "fa-heart-pulse",
                        category: "Cardiología"
                    },
                    {
                        title: "Simulador de Radiografías",
                        description: "Simulador de lectura de radiografías",
                        url: "https://radiologysim.com",
                        icon: "fa-x-ray",
                        category: "Imágenes"
                    }
                ]
            },
            evaluacion: {
                title: "Evaluación y Progreso",
                icon: "fa-clipboard-check",
                description: "Sistema de evaluación y seguimiento de tu progreso en el aprendizaje",
                quizzes: {
                    curaciones: [
                        {
                            question: "¿Cuál es el primer paso en la curación de una herida quirúrgica?",
                            options: [
                                "Aplicar el antiséptico",
                                "Lavado de manos y colocación de guantes",
                                "Retirar el apósito anterior",
                                "Evaluar características de la herida"
                            ],
                            correct: 1
                        },
                        {
                            question: "¿Qué solución se recomienda para limpiar la mayoría de las heridas?",
                            options: [
                                "Agua oxigenada",
                                "Solución salina fisiológica",
                                "Alcohol etílico",
                                "Povidona yodada"
                            ],
                            correct: 1
                        }
                    ],
                    cardiologia: [
                        {
                            question: "¿Cuál es el primer paso en el manejo del IAMCEST?",
                            options: [
                                "Administrar aspirina",
                                "Confirmación diagnóstica con ECG",
                                "Establecer acceso venoso",
                                "Administrar clopidogrel"
                            ],
                            correct: 1
                        },
                        {
                            question: "¿Cuál es el objetivo de puerta-balón en IAMCEST?",
                            options: [
                                "<30 minutos",
                                "<60 minutos",
                                "<90 minutos",
                                "<120 minutos"
                            ],
                            correct: 2
                        }
                    ]
                },
                progress: {
                    scores: {},
                    completedQuizzes: [],
                    recentCategories: []
                },
                resources: [
                    {
                        title: "Quiz de ECG",
                        description: "Evaluación de interpretación de electrocardiogramas",
                        url: "https://ecgquiz.com",
                        icon: "fa-heart-pulse",
                        category: "Cardiología"
                    },
                    {
                        title: "Quiz de Radiografías",
                        description: "Evaluación de lectura de imágenes",
                        url: "https://radiologyquiz.com",
                        icon: "fa-x-ray",
                        category: "Imágenes"
                    }
                ]
            }
        };

        // Estado actual
        let currentCategory = 'emergencias';
        let searchTimeout = null;
        let currentQuiz = null;
        let currentQuizIndex = 0;
        let theme = 'light';
        
        // Nuevas variables para funcionalidades mejoradas
        let favorites = [];
        let searchHistory = [];
        let appHistory = [];

        // Funciones de utilidad
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function saveToLocalStorage() {
            try {
                localStorage.setItem('medicalAppData', JSON.stringify(medicalData));
                localStorage.setItem('medicalAppState', JSON.stringify({
                    currentCategory: currentCategory,
                    theme: theme
                }));
                
                // Guardar nuevas funcionalidades
                localStorage.setItem('medicalAppFavorites', JSON.stringify(favorites));
                localStorage.setItem('medicalAppSearchHistory', JSON.stringify(searchHistory));
                localStorage.setItem('medicalAppHistory', JSON.stringify(appHistory));
                
                showNotification('Cambios guardados correctamente');
            } catch (e) {
                console.error('Error saving to localStorage:', e);
                showNotification('Error al guardar los datos', 'error');
            }
        }

        function loadFromLocalStorage() {
            try {
                const savedData = localStorage.getItem('medicalAppData');
                if (savedData) {
                    // Solo cargar datos si no están ya definidos
                    const parsedData = JSON.parse(savedData);
                    Object.keys(parsedData).forEach(key => {
                        if (!medicalData[key]) {
                            medicalData[key] = parsedData[key];
                        }
                    });
                }
                
                const savedState = localStorage.getItem('medicalAppState');
                if (savedState) {
                    const state = JSON.parse(savedState);
                    currentCategory = state.currentCategory || 'emergencias';
                    theme = state.theme || 'light';
                    
                    // Aplicar tema
                    if (theme === 'dark') {
                        document.body.style.background = 'linear-gradient(135deg, #1a202c 0%, #2d3748 100%)';
                        document.querySelector('.theme-toggle').innerHTML = '<i class="fas fa-moon"></i>';
                    }
                }
                
                // Cargar nuevas funcionalidades
                const savedFavorites = localStorage.getItem('medicalAppFavorites');
                if (savedFavorites) favorites = JSON.parse(savedFavorites);
                
                const savedSearchHistory = localStorage.getItem('medicalAppSearchHistory');
                if (savedSearchHistory) searchHistory = JSON.parse(savedSearchHistory);
                
                const savedAppHistory = localStorage.getItem('medicalAppHistory');
                if (savedAppHistory) appHistory = JSON.parse(savedAppHistory);
                
            } catch (e) {
                console.error('Error loading from localStorage:', e);
            }
        }

        function formatDate(dateString) {
            if (!dateString) return "Fecha no disponible";
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            return new Date(dateString).toLocaleDateString('es-ES', options);
        }

        // Funciones de renderizado
        function renderEmergenciasContent(data) {
            if (!data || !data.procedures) {
                return '<div class="empty-state"><i class="fas fa-exclamation-circle"></i><h3>Datos no disponibles</h3><p>No hay información para mostrar en este momento.</p></div>';
            }
            
            return `
                <div class="page-header">
                    <h1 class="page-title"><i class="fas ${data.icon}"></i> ${data.title}</h1>
                    <p class="page-description">${data.description}</p>
                </div>
                <div class="tabs">
                    <div class="tab active" data-tab="procedures">Procedimientos</div>
                    <div class="tab" data-tab="diseases">Enfermedades</div>
                    <div class="tab" data-tab="protocols">Protocolos</div>
                    <div class="tab" data-tab="resources">Recursos</div>
                </div>
                <div class="tab-content active" id="procedures">
                    ${data.procedures.map(procedure => `
                        <div class="procedure-detail" id="${procedure.id}">
                            <div class="procedure-header">
                                <i class="fas ${procedure.icon} procedure-icon"></i>
                                <h2 class="procedure-title">${procedure.title}</h2>
                                <button class="bookmark-btn" onclick="toggleFavorite('emergencias', '${procedure.id}')">
                                    <i class="fas fa-bookmark"></i>
                                </button>
                            </div>
                            <p class="procedure-summary">${procedure.summary}</p>
                            <h3 class="section-title"><i class="fas fa-box-open"></i> Materiales</h3>
                            <div class="materials-list">
                                ${procedure.materials.map(material => `<span class="material-tag">${material}</span>`).join('')}
                            </div>
                            <h3 class="section-title"><i class="fas fa-list-ol"></i> Pasos del Procedimiento</h3>
                            <ol class="steps-list">
                                ${procedure.steps.map(step => `<li>${step}</li>`).join('')}
                            </ol>
                            <div class="notes">
                                <i class="fas fa-lightbulb"></i>
                                <strong>Nota:</strong> ${procedure.notes}
                            </div>
                            ${procedure.visualReferences && procedure.visualReferences.length > 0 ? `
                                <div class="visual-reference">
                                    <img src="${procedure.visualReferences[0].url}" alt="${procedure.visualReferences[0].title}" onerror="this.src='https://via.placeholder.com/800x400?text=Imagen+no+disponible'">
                                    <div class="caption">${procedure.visualReferences[0].description}</div>
                                </div>
                            ` : ''}
                            <div class="source">
                                <i class="fas fa-book"></i>
                                Fuente: <a href="${procedure.source.url}" target="_blank">${procedure.source.name}</a>
                                <span class="last-updated">Actualizado: ${formatDate(procedure.lastUpdated)}</span>
                            </div>
                        </div>
                    `).join('')}
                </div>
                <div class="tab-content" id="diseases">
                    ${data.diseases && data.diseases.length > 0 ? data.diseases.map(disease => `
                        <div class="disease-card" id="${disease.id}">
                            <div class="disease-header">
                                <div class="disease-title">${disease.name}</div>
                                <div class="disease-prevalence">${disease.prevalence}</div>
                            </div>
                            <p class="disease-description">${disease.description}</p>
                            <div class="disease-symptoms">
                                <i class="fas fa-dna"></i>
                                <strong>Síntomas:</strong>
                                <ul>
                                    ${disease.symptoms.map(symptom => `<li>${symptom}</li>`).join('')}
                                </ul>
                            </div>
                            <div class="disease-diagnosis">
                                <i class="fas fa-diagnoses"></i>
                                <strong>Diagnóstico:</strong>
                                <ul>
                                    ${disease.diagnosis.map(diag => `<li>${diag}</li>`).join('')}
                                </ul>
                            </div>
                            <div class="disease-treatment">
                                <i class="fas fa-pills"></i>
                                <strong>Tratamiento:</strong>
                                <ul>
                                    ${disease.treatment.map(treat => `<li>${treat}</li>`).join('')}
                                </ul>
                            </div>
                            <div class="source">
                                <i class="fas fa-book"></i>
                                Fuentes: ${disease.sources.map(source => `<a href="${source.url}" target="_blank">${source.name}</a>`).join(' • ')}
                                <span class="last-updated">Actualizado: ${formatDate(disease.lastUpdated)}</span>
                            </div>
                        </div>
                    `).join('') : '<div class="empty-state"><i class="fas fa-info-circle"></i><p>No hay enfermedades registradas en esta categoría.</p></div>'}
                </div>
                <div class="tab-content" id="protocols">
                    ${data.protocols && data.protocols.length > 0 ? data.protocols.map(protocol => `
                        <div class="protocol-container" id="${protocol.id}">
                            <div class="protocol-header">
                                <i class="fas fa-clipboard-check protocol-icon"></i>
                                <h2 class="protocol-title">${protocol.name}</h2>
                            </div>
                            <p class="protocol-summary">Nivel de evidencia: ${protocol.level}</p>
                            <h3 class="section-title"><i class="fas fa-list-ol"></i> Pasos del Protocolo</h3>
                            <div class="protocol-steps">
                                ${protocol.steps.map(step => `<div class="protocol-step">${step}</div>`).join('')}
                            </div>
                            <div class="source">
                                <i class="fas fa-book"></i>
                                Fuente: <a href="${protocol.source.url}" target="_blank">${protocol.source.name}</a>
                                <span class="last-updated">Actualizado: ${formatDate(protocol.lastUpdated)}</span>
                            </div>
                        </div>
                    `).join('') : '<div class="empty-state"><i class="fas fa-info-circle"></i><p>No hay protocolos registrados en esta categoría.</p></div>'}
                </div>
                <div class="tab-content" id="resources">
                    <div class="resources-grid">
                        ${data.resources && data.resources.length > 0 ? data.resources.map(resource => `
                            <div class="resource-card">
                                <h3><i class="fas ${resource.icon}"></i> ${resource.title}</h3>
                                <p><i class="fas fa-info-circle"></i> ${resource.description}</p>
                                <p><i class="fas fa-tags"></i> Categoría: ${resource.category}</p>
                                <a href="${resource.url}" target="_blank" class="resource-link"><i class="fas fa-external-link-alt"></i> Visitar Recurso</a>
                            </div>
                        `).join('') : '<div class="empty-state"><i class="fas fa-info-circle"></i><p>No hay recursos registrados en esta categoría.</p></div>'}
                    </div>
                </div>
            `;
        }

        function renderFarmacologiaContent(data) {
            if (!data || !data.medications) {
                return '<div class="empty-state"><i class="fas fa-exclamation-circle"></i><h3>Datos no disponibles</h3><p>No hay información para mostrar en este momento.</p></div>';
            }
            
            return `
                <div class="page-header">
                    <h1 class="page-title"><i class="fas ${data.icon}"></i> ${data.title}</h1>
                    <p class="page-description">${data.description}</p>
                </div>
                ${data.medications.map(medication => `
                    <div class="card" id="${medication.id}">
                        <div class="card-header">
                            <i class="fas fa-pills card-icon"></i>
                            <h3 class="card-title">${medication.name}</h3>
                            <button class="bookmark-btn" onclick="toggleFavorite('farmacologia', '${medication.id}')">
                                <i class="fas fa-bookmark"></i>
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="info-grid">
                                <div class="info-item">
                                    <div class="info-label"><i class="fas fa-flask"></i> Clase Farmacológica</div>
                                    <div class="info-value">${medication.class}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label"><i class="fas fa-list"></i> Indicaciones</div>
                                    <div class="info-value">${medication.indications.join(', ')}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label"><i class="fas fa-prescription"></i> Dosificación</div>
                                    <div class="info-value">${medication.dosage}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label"><i class="fas fa-ban"></i> Contraindicaciones</div>
                                    <div class="info-value">${medication.contraindications.join(', ')}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label"><i class="fas fa-exclamation-triangle"></i> Efectos Secundarios</div>
                                    <div class="info-value">${medication.sideEffects.join(', ')}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label"><i class="fas fa-microscope"></i> Farmacocinética</div>
                                    <div class="info-value">${medication.pharmacokinetics}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label"><i class="fas fa-warning"></i> Precauciones</div>
                                    <div class="info-value">${medication.warnings}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label"><i class="fas fa-box"></i> Almacenamiento</div>
                                    <div class="info-value">${medication.storage}</div>
                                </div>
                            </div>
                            <h3 class="section-title"><i class="fas fa-exchange-alt"></i> Interacciones Medicamentosas</h3>
                            ${medication.interactions.map(interaction => `
                                <div class="notes" style="border-left-color: ${interaction.severity === 'Severa' ? '#e53e3e' : '#f6ad55'};">
                                    <i class="fas ${interaction.severity === 'Severa' ? 'fa-exclamation-triangle' : 'fa-exclamation-circle'}"></i>
                                    <strong>${interaction.severity}: ${interaction.drug}</strong>
                                    <p><strong>Mecanismo:</strong> ${interaction.mechanism}</p>
                                    <p><strong>Recomendación:</strong> ${interaction.recommendation}</p>
                                </div>
                            `).join('')}
                            ${medication.images && medication.images.length > 0 ? `
                                <div class="image-gallery">
                                    ${medication.images.map(img => `
                                        <div class="image-item">
                                            <img src="${img}" alt="${medication.name}" onerror="this.src='https://via.placeholder.com/400x300?text=Imagen+no+disponible'">
                                            <div class="caption">${medication.name}</div>
                                        </div>
                                    `).join('')}
                                </div>
                            ` : ''}
                            <div class="source">
                                <i class="fas fa-book"></i>
                                Fuentes: 
                                ${medication.sources.map(source => `
                                    <a href="${source.url}" target="_blank">${source.name}</a>
                                `).join(', ')}
                                <span class="last-updated">Actualizado: ${formatDate(medication.lastUpdated)}</span>
                            </div>
                        </div>
                    </div>
                `).join('')}
                <div class="resources-grid">
                    ${data.resources && data.resources.length > 0 ? data.resources.map(resource => `
                        <div class="resource-card">
                            <h3><i class="fas ${resource.icon}"></i> ${resource.title}</h3>
                            <p><i class="fas fa-info-circle"></i> ${resource.description}</p>
                            <p><i class="fas fa-tags"></i> Categoría: ${resource.category}</p>
                            <a href="${resource.url}" target="_blank" class="resource-link"><i class="fas fa-external-link-alt"></i> Visitar Recurso</a>
                        </div>
                    `).join('') : '<div class="empty-state"><i class="fas fa-info-circle"></i><p>No hay recursos registrados en esta categoría.</p></div>'}
                </div>
            `;
        }

        function renderProcedimientosContent(data) {
            if (!data || !data.procedures) {
                return '<div class="empty-state"><i class="fas fa-exclamation-circle"></i><h3>Datos no disponibles</h3><p>No hay información para mostrar en este momento.</p></div>';
            }
            
            return `
                <div class="page-header">
                    <h1 class="page-title"><i class="fas ${data.icon}"></i> ${data.title}</h1>
                    <p class="page-description">${data.description}</p>
                </div>
                <div class="tabs">
                    <div class="tab active" data-tab="procedures">Procedimientos</div>
                    <div class="tab" data-tab="resources">Recursos</div>
                </div>
                <div class="tab-content active" id="procedures">
                    ${data.procedures.map(procedure => `
                        <div class="procedure-detail" id="${procedure.id}">
                            <div class="procedure-header">
                                <i class="fas ${procedure.icon} procedure-icon"></i>
                                <h2 class="procedure-title">${procedure.title}</h2>
                                <button class="bookmark-btn" onclick="toggleFavorite('procedimientos', '${procedure.id}')">
                                    <i class="fas fa-bookmark"></i>
                                </button>
                            </div>
                            <p class="procedure-summary">${procedure.summary}</p>
                            <h3 class="section-title"><i class="fas fa-box-open"></i> Materiales</h3>
                            <div class="materials-list">
                                ${procedure.materials.map(material => `<span class="material-tag">${material}</span>`).join('')}
                            </div>
                            <h3 class="section-title"><i class="fas fa-list-ol"></i> Pasos del Procedimiento</h3>
                            <ol class="steps-list">
                                ${procedure.steps.map(step => `<li>${step}</li>`).join('')}
                            </ol>
                            <div class="notes">
                                <i class="fas fa-lightbulb"></i>
                                <strong>Nota:</strong> ${procedure.notes}
                            </div>
                            ${procedure.visualReferences && procedure.visualReferences.length > 0 ? `
                                <div class="visual-reference">
                                    <img src="${procedure.visualReferences[0].url}" alt="${procedure.visualReferences[0].title}" onerror="this.src='https://via.placeholder.com/800x400?text=Imagen+no+disponible'">
                                    <div class="caption">${procedure.visualReferences[0].description}</div>
                                </div>
                            ` : ''}
                            <div class="source">
                                <i class="fas fa-book"></i>
                                Fuente: <a href="${procedure.source.url}" target="_blank">${procedure.source.name}</a>
                                <span class="last-updated">Actualizado: ${formatDate(procedure.lastUpdated)}</span>
                            </div>
                        </div>
                    `).join('')}
                </div>
                <div class="tab-content" id="resources">
                    <div class="resources-grid">
                        ${data.resources && data.resources.length > 0 ? data.resources.map(resource => `
                            <div class="resource-card">
                                <h3><i class="fas ${resource.icon}"></i> ${resource.title}</h3>
                                <p><i class="fas fa-info-circle"></i> ${resource.description}</p>
                                <p><i class="fas fa-tags"></i> Categoría: ${resource.category}</p>
                                <a href="${resource.url}" target="_blank" class="resource-link"><i class="fas fa-external-link-alt"></i> Visitar Recurso</a>
                            </div>
                        `).join('') : '<div class="empty-state"><i class="fas fa-info-circle"></i><p>No hay recursos registrados en esta categoría.</p></div>'}
                    </div>
                </div>
            `;
        }

        function renderEnfermedadesContent(data) {
            if (!data || !data.diseases) {
                return '<div class="empty-state"><i class="fas fa-exclamation-circle"></i><h3>Datos no disponibles</h3><p>No hay información para mostrar en este momento.</p></div>';
            }
            
            return `
                <div class="page-header">
                    <h1 class="page-title"><i class="fas ${data.icon}"></i> ${data.title}</h1>
                    <p class="page-description">${data.description}</p>
                </div>
                <div class="tabs">
                    <div class="tab active" data-tab="diseases">Enfermedades</div>
                    <div class="tab" data-tab="resources">Recursos</div>
                </div>
                <div class="tab-content active" id="diseases">
                    ${data.diseases.map(disease => `
                        <div class="disease-card" id="${disease.id}">
                            <div class="disease-header">
                                <div class="disease-title">${disease.name}</div>
                                <div class="disease-prevalence">${disease.prevalence}</div>
                            </div>
                            <p class="disease-description">${disease.description}</p>
                            <div class="disease-symptoms">
                                <i class="fas fa-dna"></i>
                                <strong>Síntomas:</strong>
                                <ul>
                                    ${disease.symptoms.map(symptom => `<li>${symptom}</li>`).join('')}
                                </ul>
                            </div>
                            <div class="disease-diagnosis">
                                <i class="fas fa-diagnoses"></i>
                                <strong>Diagnóstico:</strong>
                                <ul>
                                    ${disease.diagnosis.map(diag => `<li>${diag}</li>`).join('')}
                                </ul>
                            </div>
                            <div class="disease-treatment">
                                <i class="fas fa-pills"></i>
                                <strong>Tratamiento:</strong>
                                <ul>
                                    ${disease.treatment.map(treat => `<li>${treat}</li>`).join('')}
                                </ul>
                            </div>
                            <div class="source">
                                <i class="fas fa-book"></i>
                                Fuentes: ${disease.sources.map(source => `<a href="${source.url}" target="_blank">${source.name}</a>`).join(' • ')}
                                <span class="last-updated">Actualizado: ${formatDate(disease.lastUpdated)}</span>
                            </div>
                        </div>
                    `).join('')}
                </div>
                <div class="tab-content" id="resources">
                    <div class="resources-grid">
                        ${data.resources && data.resources.length > 0 ? data.resources.map(resource => `
                            <div class="resource-card">
                                <h3><i class="fas ${resource.icon}"></i> ${resource.title}</h3>
                                <p><i class="fas fa-info-circle"></i> ${resource.description}</p>
                                <p><i class="fas fa-tags"></i> Categoría: ${resource.category}</p>
                                <a href="${resource.url}" target="_blank" class="resource-link"><i class="fas fa-external-link-alt"></i> Visitar Recurso</a>
                            </div>
                        `).join('') : '<div class="empty-state"><i class="fas fa-info-circle"></i><p>No hay recursos registrados en esta categoría.</p></div>'}
                    </div>
                </div>
            `;
        }

        function renderNutricionContent(data) {
            if (!data || !data.procedures) {
                return '<div class="empty-state"><i class="fas fa-exclamation-circle"></i><h3>Datos no disponibles</h3><p>No hay información para mostrar en este momento.</p></div>';
            }
            
            return `
                <div class="page-header">
                    <h1 class="page-title"><i class="fas ${data.icon}"></i> ${data.title}</h1>
                    <p class="page-description">${data.description}</p>
                </div>
                <div class="tabs">
                    <div class="tab active" data-tab="procedures">Procedimientos</div>
                    <div class="tab" data-tab="diseases">Enfermedades</div>
                    <div class="tab" data-tab="resources">Recursos</div>
                </div>
                <div class="tab-content active" id="procedures">
                    ${data.procedures.map(procedure => `
                        <div class="procedure-detail" id="${procedure.id}">
                            <div class="procedure-header">
                                <i class="fas ${procedure.icon} procedure-icon"></i>
                                <h2 class="procedure-title">${procedure.title}</h2>
                                <button class="bookmark-btn" onclick="toggleFavorite('nutricion', '${procedure.id}')">
                                    <i class="fas fa-bookmark"></i>
                                </button>
                            </div>
                            <p class="procedure-summary">${procedure.summary}</p>
                            <h3 class="section-title"><i class="fas fa-box-open"></i> Materiales</h3>
                            <div class="materials-list">
                                ${procedure.materials.map(material => `<span class="material-tag">${material}</span>`).join('')}
                            </div>
                            <h3 class="section-title"><i class="fas fa-list-ol"></i> Pasos del Procedimiento</h3>
                            <ol class="steps-list">
                                ${procedure.steps.map(step => `<li>${step}</li>`).join('')}
                            </ol>
                            <div class="notes">
                                <i class="fas fa-lightbulb"></i>
                                <strong>Nota:</strong> ${procedure.notes}
                            </div>
                            <div class="source">
                                <i class="fas fa-book"></i>
                                Fuente: <a href="${procedure.source.url}" target="_blank">${procedure.source.name}</a>
                                <span class="last-updated">Actualizado: ${formatDate(procedure.lastUpdated)}</span>
                            </div>
                        </div>
                    `).join('')}
                </div>
                <div class="tab-content" id="diseases">
                    ${data.diseases && data.diseases.length > 0 ? data.diseases.map(disease => `
                        <div class="disease-card" id="${disease.id}">
                            <div class="disease-header">
                                <div class="disease-title">${disease.name}</div>
                                <div class="disease-prevalence">${disease.prevalence}</div>
                            </div>
                            <p class="disease-description">${disease.description}</p>
                            <div class="disease-symptoms">
                                <i class="fas fa-dna"></i>
                                <strong>Síntomas:</strong>
                                <ul>
                                    ${disease.symptoms.map(symptom => `<li>${symptom}</li>`).join('')}
                                </ul>
                            </div>
                            <div class="disease-diagnosis">
                                <i class="fas fa-diagnoses"></i>
                                <strong>Diagnóstico:</strong>
                                <ul>
                                    ${disease.diagnosis.map(diag => `<li>${diag}</li>`).join('')}
                                </ul>
                            </div>
                            <div class="disease-treatment">
                                <i class="fas fa-pills"></i>
                                <strong>Tratamiento:</strong>
                                <ul>
                                    ${disease.treatment.map(treat => `<li>${treat}</li>`).join('')}
                                </ul>
                            </div>
                            <div class="source">
                                <i class="fas fa-book"></i>
                                Fuentes: ${disease.sources.map(source => `<a href="${source.url}" target="_blank">${source.name}</a>`).join(' • ')}
                                <span class="last-updated">Actualizado: ${formatDate(disease.lastUpdated)}</span>
                            </div>
                        </div>
                    `).join('') : '<div class="empty-state"><i class="fas fa-info-circle"></i><p>No hay enfermedades registradas en esta categoría.</p></div>'}
                </div>
                <div class="tab-content" id="resources">
                    <div class="resources-grid">
                        ${data.resources && data.resources.length > 0 ? data.resources.map(resource => `
                            <div class="resource-card">
                                <h3><i class="fas ${resource.icon}"></i> ${resource.title}</h3>
                                <p><i class="fas fa-info-circle"></i> ${resource.description}</p>
                                <p><i class="fas fa-tags"></i> Categoría: ${resource.category}</p>
                                <a href="${resource.url}" target="_blank" class="resource-link"><i class="fas fa-external-link-alt"></i> Visitar Recurso</a>
                            </div>
                        `).join('') : '<div class="empty-state"><i class="fas fa-info-circle"></i><p>No hay recursos registrados en esta categoría.</p></div>'}
                    </div>
                </div>
            `;
        }

        function renderRecursosContent(data) {
            if (!data || !data.resources) {
                return '<div class="empty-state"><i class="fas fa-exclamation-circle"></i><h3>Datos no disponibles</h3><p>No hay información para mostrar en este momento.</p></div>';
            }
            
            return `
                <div class="page-header">
                    <h1 class="page-title"><i class="fas ${data.icon}"></i> ${data.title}</h1>
                    <p class="page-description">${data.description}</p>
                </div>
                <div class="tabs">
                    <div class="tab active" data-tab="resources">Recursos</div>
                    <div class="tab" data-tab="external">Enlaces Externos</div>
                    <div class="tab" data-tab="videos">Videos Recomendados</div>
                </div>
                <div class="tab-content active" id="resources">
                    <div class="resources-grid">
                        ${data.resources.map(resource => `
                            <div class="resource-card">
                                <h3><i class="fas ${resource.icon}"></i> ${resource.title}</h3>
                                <p><i class="fas fa-info-circle"></i> ${resource.description}</p>
                                <p><i class="fas fa-tags"></i> Categoría: ${resource.category}</p>
                                <a href="${resource.url}" target="_blank" class="resource-link"><i class="fas fa-external-link-alt"></i> Acceder</a>
                            </div>
                        `).join('')}
                    </div>
                </div>
                <div class="tab-content" id="external">
                    <div class="external-links">
                        <h3><i class="fas fa-link"></i> Enlaces Externos Recomendados</h3>
                        ${data.externalLinks.map(link => `
                            <a href="${link.url}" target="_blank">
                                <i class="fas ${link.icon}"></i>
                                <div>
                                    <div>${link.title}</div>
                                    <div style="color: var(--text-light); font-size: 0.9rem;">${link.description}</div>
                                </div>
                            </a>
                        `).join('')}
                    </div>
                </div>
                <div class="tab-content" id="videos">
                    <div class="video-resources">
                        ${data.videos.map(video => `
                            <div class="video-card">
                                <img src="${video.thumbnail}" alt="${video.title}" class="video-thumbnail" onerror="this.src='https://via.placeholder.com/300x180?text=Imagen+no+disponible'">
                                <div class="video-info">
                                    <div class="video-title">${video.title}</div>
                                    <div class="video-meta">
                                        <div><i class="fas fa-eye"></i> ${video.views.toLocaleString()} vistas</div>
                                        <div><i class="fas fa-star"></i> ${video.rating}</div>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderSimuladorContent(data) {
            if (!data || !data.vitals) {
                return '<div class="empty-state"><i class="fas fa-exclamation-circle"></i><h3>Datos no disponibles</h3><p>No hay información para mostrar en este momento.</p></div>';
            }
            
            return `
                <div class="page-header">
                    <h1 class="page-title"><i class="fas ${data.icon}"></i> ${data.title}</h1>
                    <p class="page-description">${data.description}</p>
                </div>
                <div class="tabs">
                    <div class="tab active" data-tab="simulator">Simulador de Signos Vitales</div>
                    <div class="tab" data-tab="resources">Recursos</div>
                </div>
                <div class="tab-content active" id="simulator">
                    <div class="vitals-grid">
                        ${data.vitals.map(vital => `
                            <div class="vital-card">
                                <div class="vital-label">${vital.label}</div>
                                <div class="vital-value" id="vital-${vital.id}">${vital.value}</div>
                                <div class="vital-unit">${vital.unit}</div>
                                <div class="normal-range">Rango normal: ${vital.normalRange[0]}-${vital.normalRange[1]} ${vital.unit}</div>
                            </div>
                        `).join('')}
                    </div>
                    <div class="controls">
                        <h3>Escenarios Clínicos:</h3>
                        ${data.scenarios.map(scenario => `
                            <button class="control-btn" onclick="applyScenario('${scenario.id}')">${scenario.name}</button>
                        `).join('')}
                        <button class="control-btn" onclick="resetVitals()">Valores Normales</button>
                    </div>
                </div>
                <div class="tab-content" id="resources">
                    <div class="resources-grid">
                        ${data.resources.map(resource => `
                            <div class="resource-card">
                                <h3><i class="fas ${resource.icon}"></i> ${resource.title}</h3>
                                <p><i class="fas fa-info-circle"></i> ${resource.description}</p>
                                <p><i class="fas fa-tags"></i> Categoría: ${resource.category}</p>
                                <a href="${resource.url}" target="_blank" class="resource-link"><i class="fas fa-external-link-alt"></i> Visitar Recurso</a>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderEvaluacionContent(data) {
            if (!data || !data.quizzes) {
                return '<div class="empty-state"><i class="fas fa-exclamation-circle"></i><h3>Datos no disponibles</h3><p>No hay información para mostrar en este momento.</p></div>';
            }
            
            return `
                <div class="page-header">
                    <h1 class="page-title"><i class="fas ${data.icon}"></i> ${data.title}</h1>
                    <p class="page-description">${data.description}</p>
                </div>
                <div class="tabs">
                    <div class="tab active" data-tab="quizzes">Evaluaciones</div>
                    <div class="tab" data-tab="progress">Progreso</div>
                    <div class="tab" data-tab="resources">Recursos</div>
                </div>
                <div class="tab-content active" id="quizzes">
                    <div class="quiz-container">
                        <h3>Selecciona un tema para evaluar:</h3>
                        <div class="controls">
                            <button class="control-btn" onclick="startQuiz('curaciones')">Curaciones</button>
                            <button class="control-btn" onclick="startQuiz('cardiologia')">Cardiología</button>
                        </div>
                    </div>
                    <div id="quizDisplay"></div>
                </div>
                <div class="tab-content" id="progress">
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-chart-bar card-icon"></i>
                            <h3 class="card-title">Detalles de Evaluaciones</h3>
                        </div>
                        <div class="card-body">
                            ${Object.keys(data.progress.scores).length > 0 ? 
                                Object.keys(data.progress.scores).map(category => `
                                    <div style="margin-bottom: 16px; padding-bottom: 16px; border-bottom: 1px solid var(--border-light);">
                                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                            <strong>${medicalData[category]?.title || category}</strong>
                                            <span style="color: ${data.progress.scores[category] >= 70 ? 'var(--success)' : 'var(--warning)'}; font-weight: 500;">
                                                ${data.progress.scores[category]}%
                                            </span>
                                        </div>
                                        <div style="font-size: 0.9rem; color: var(--text-light);">
                                            Última evaluación: ${new Date(data.progress.completedQuizzes.find(q => q.quiz === category)?.date || '').toLocaleDateString('es-ES')}
                                        </div>
                                    </div>
                                `).join('') : 
                                '<p>No has completado ninguna evaluación aún.</p>'
                            }
                        </div>
                    </div>
                </div>
                <div class="tab-content" id="resources">
                    <div class="resources-grid">
                        ${data.resources.map(resource => `
                            <div class="resource-card">
                                <h3><i class="fas ${resource.icon}"></i> ${resource.title}</h3>
                                <p><i class="fas fa-info-circle"></i> ${resource.description}</p>
                                <p><i class="fas fa-tags"></i> Categoría: ${resource.category}</p>
                                <a href="${resource.url}" target="_blank" class="resource-link"><i class="fas fa-external-link-alt"></i> Visitar Recurso</a>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderDefaultContent(data) {
            return `
                <div class="empty-state">
                    <i class="fas fa-exclamation-circle"></i>
                    <h3>Contenido en Desarrollo</h3>
                    <p>El contenido para ${data.title} está actualmente en desarrollo. Por favor, revisite más tarde.</p>
                </div>
            `;
        }

        function renderContent(category) {
            const mainContent = document.getElementById('mainContent');
            const loading = document.createElement('div');
            loading.className = 'loading';
            loading.innerHTML = '<i class="fas fa-spinner"></i> Cargando contenido...';
            mainContent.innerHTML = '';
            mainContent.appendChild(loading);

            setTimeout(() => {
                let content = '';
                const data = medicalData[category];

                if (data) {
                    switch (category) {
                        case 'emergencias':
                            content = renderEmergenciasContent(data);
                            break;
                        case 'farmacologia':
                            content = renderFarmacologiaContent(data);
                            break;
                        case 'procedimientos':
                            content = renderProcedimientosContent(data);
                            break;
                        case 'enfermedades':
                            content = renderEnfermedadesContent(data);
                            break;
                        case 'nutricion':
                            content = renderNutricionContent(data);
                            break;
                        case 'recursos':
                            content = renderRecursosContent(data);
                            break;
                        case 'simulador':
                            content = renderSimuladorContent(data);
                            break;
                        case 'evaluacion':
                            content = renderEvaluacionContent(data);
                            break;
                        default:
                            content = renderDefaultContent(data);
                    }
                } else {
                    content = `
                        <div class="empty-state">
                            <i class="fas fa-exclamation-circle"></i>
                            <h3>Contenido no disponible</h3>
                            <p>Lo sentimos, el contenido para esta categoría aún está en desarrollo.</p>
                        </div>
                    `;
                }

                mainContent.innerHTML = content;
                
                // Configurar pestañas
                setupTabs();
            }, 300);
        }

        function setupTabs() {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // Remover clase active de todas las pestañas
                    tabs.forEach(t => t.classList.remove('active'));
                    
                    // Añadir clase active a la pestaña clickeada
                    this.classList.add('active');
                    
                    // Ocultar todos los contenidos
                    const tabContents = document.querySelectorAll('.tab-content');
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    // Mostrar el contenido correspondiente
                    const tabId = this.getAttribute('data-tab');
                    const content = document.getElementById(tabId);
                    if (content) {
                        content.classList.add('active');
                    }
                });
            });
        }

        // Nuevas funciones para funcionalidades mejoradas
        function addToHistory(category, itemId = null) {
            const timestamp = new Date().toISOString();
            const historyItem = {
                category,
                itemId,
                timestamp
            };
            
            // Mantener solo los últimos 20 elementos en el historial
            appHistory.unshift(historyItem);
            if (appHistory.length > 20) {
                appHistory.pop();
            }
            
            saveToLocalStorage();
        }

        function addToSearchHistory(searchTerm) {
            if (!searchTerm.trim()) return;
            
            // Evitar duplicados consecutivos
            if (searchHistory.length > 0 && searchHistory[0] === searchTerm) return;
            
            searchHistory.unshift(searchTerm);
            
            // Mantener solo las últimas 10 búsquedas
            if (searchHistory.length > 10) {
                searchHistory.pop();
            }
            
            saveToLocalStorage();
        }

        function toggleFavorite(category, itemId) {
            const index = favorites.findIndex(fav => fav.category === category && fav.itemId === itemId);
            
            if (index === -1) {
                // Añadir a favoritos
                favorites.push({ category, itemId });
                showNotification('Añadido a favoritos');
            } else {
                // Quitar de favoritos
                favorites.splice(index, 1);
                showNotification('Eliminado de favoritos');
            }
            
            saveToLocalStorage();
            renderContent(currentCategory); // Volver a renderizar para actualizar botones
        }

        function isFavorite(category, itemId) {
            return favorites.some(fav => fav.category === category && fav.itemId === itemId);
        }

        // Funciones de búsqueda
        function handleSearch() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const suggestionsContainer = document.getElementById('searchSuggestions');
            
            if (searchTerm.length < 2) {
                suggestionsContainer.style.display = 'none';
                return;
            }
            
            // Añadir a historial de búsquedas
            addToSearchHistory(searchTerm);
            
            // Buscar en todos los datos
            const results = [];
            
            // Buscar en todas las categorías
            Object.keys(medicalData).forEach(categoryKey => {
                const category = medicalData[categoryKey];
                
                // Buscar en procedimientos
                if (category.procedures) {
                    category.procedures.forEach(procedure => {
                        if (procedure.title.toLowerCase().includes(searchTerm) || 
                            procedure.summary.toLowerCase().includes(searchTerm) ||
                            procedure.notes.toLowerCase().includes(searchTerm)) {
                            results.push({
                                type: 'Procedimiento',
                                title: procedure.title,
                                content: procedure.summary,
                                category: categoryKey,
                                id: procedure.id
                            });
                        }
                    });
                }
                
                // Buscar en enfermedades
                if (category.diseases) {
                    category.diseases.forEach(disease => {
                        if (disease.name.toLowerCase().includes(searchTerm) || 
                            disease.description.toLowerCase().includes(searchTerm) ||
                            (disease.symptoms && disease.symptoms.some(s => s.toLowerCase().includes(searchTerm)))) {
                            results.push({
                                type: 'Enfermedad',
                                title: disease.name,
                                content: disease.description.substring(0, 100) + '...',
                                category: categoryKey,
                                id: disease.id
                            });
                        }
                    });
                }
                
                // Buscar en medicamentos
                if (category.medications) {
                    category.medications.forEach(medication => {
                        if (medication.name.toLowerCase().includes(searchTerm) || 
                            medication.class.toLowerCase().includes(searchTerm) ||
                            (medication.indications && medication.indications.some(i => i.toLowerCase().includes(searchTerm)))) {
                            results.push({
                                type: 'Medicamento',
                                title: medication.name,
                                content: medication.class,
                                category: categoryKey,
                                id: medication.id
                            });
                        }
                    });
                }
                
                // Buscar en recursos
                if (category.resources) {
                    category.resources.forEach(resource => {
                        if (resource.title.toLowerCase().includes(searchTerm) || 
                            resource.description.toLowerCase().includes(searchTerm)) {
                            results.push({
                                type: 'Recurso',
                                title: resource.title,
                                content: resource.description,
                                category: categoryKey,
                                id: resource.title
                            });
                        }
                    });
                }
            });
            
            // Mostrar resultados
            if (results.length > 0) {
                let suggestionsHtml = '';
                results.slice(0, 8).forEach(result => {
                    suggestionsHtml += `
                        <div class="suggestion-item" onclick="selectSuggestion('${result.category}', '${result.id}')">
                            <span class="suggestion-category">${result.type}</span>
                            <div>
                                <div>${result.title}</div>
                                <div style="color: var(--text-light); font-size: 0.9rem;">${result.content}</div>
                            </div>
                        </div>
                    `;
                });
                
                suggestionsContainer.innerHTML = suggestionsHtml;
                suggestionsContainer.style.display = 'block';
            } else {
                suggestionsContainer.innerHTML = `
                    <div class="suggestion-item">
                        <div>No se encontraron resultados para "${searchTerm}"</div>
                    </div>
                `;
                suggestionsContainer.style.display = 'block';
            }
        }

        function selectSuggestion(category, id) {
            activateCategory(category);
            document.getElementById('searchInput').value = '';
            document.getElementById('searchSuggestions').style.display = 'none';
            
            // Desplazar a la sección específica después de un breve retraso
            setTimeout(() => {
                const element = document.getElementById(id);
                if (element) {
                    element.scrollIntoView({ behavior: 'smooth' });
                }
            }, 300);
        }

        // Funciones de simulador
        function initializeVitals() {
            medicalData.simulador.vitals.forEach(vital => {
                document.getElementById(`vital-${vital.id}`).textContent = vital.value;
            });
        }

        function applyScenario(scenarioId) {
            const scenario = medicalData.simulador.scenarios.find(s => s.id === scenarioId);
            if (!scenario) return;
            
            medicalData.simulador.vitals.forEach(vital => {
                const newValue = scenario.changes[vital.id]?.value || vital.value;
                const element = document.getElementById(`vital-${vital.id}`);
                element.textContent = newValue;
                
                if (scenario.changes[vital.id]?.color) {
                    element.style.color = scenario.changes[vital.id].color;
                } else {
                    element.style.color = 'inherit';
                }
            });
            
            showNotification(`Escenario aplicado: ${scenario.name}`);
        }

        function resetVitals() {
            medicalData.simulador.vitals.forEach(vital => {
                const element = document.getElementById(`vital-${vital.id}`);
                element.textContent = vital.value;
                element.style.color = 'inherit';
            });
            
            showNotification('Valores restablecidos a normales');
        }

        // Funciones de evaluación
        function startQuiz(topic) {
            currentQuiz = topic;
            currentQuizIndex = 0;
            showQuizQuestion();
        }

        function showQuizQuestion() {
            const quizDisplay = document.getElementById('quizDisplay');
            const questions = medicalData.evaluacion.quizzes[currentQuiz];
            const question = questions[currentQuizIndex];
            
            let optionsHtml = '';
            question.options.forEach((option, index) => {
                optionsHtml += `<li class="quiz-option" onclick="selectOption(this, ${index})">${option}</li>`;
            });
            
            quizDisplay.innerHTML = `
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-question-circle card-icon"></i>
                        <h3 class="card-title">Pregunta ${currentQuizIndex + 1} de ${questions.length}</h3>
                    </div>
                    <div class="card-body">
                        <div class="quiz-question">${question.question}</div>
                        <ul class="quiz-options">
                            ${optionsHtml}
                        </ul>
                        <div id="quizFeedback"></div>
                        <div class="action-buttons">
                            <button class="btn btn-secondary" onclick="prevQuestion()" ${currentQuizIndex === 0 ? 'disabled' : ''}>Anterior</button>
                            <button class="btn btn-primary" onclick="nextQuestion()">Siguiente</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function selectOption(element, index) {
            // Remover selección anterior
            const options = document.querySelectorAll('.quiz-option');
            options.forEach(opt => opt.classList.remove('selected'));
            
            // Añadir selección actual
            element.classList.add('selected');
            
            // Mostrar feedback
            const questions = medicalData.evaluacion.quizzes[currentQuiz];
            const question = questions[currentQuizIndex];
            const feedback = document.getElementById('quizFeedback');
            
            if (index === question.correct) {
                feedback.innerHTML = '<div class="quiz-feedback correct"><i class="fas fa-check"></i> ¡Correcto!</div>';
            } else {
                feedback.innerHTML = `<div class="quiz-feedback incorrect"><i class="fas fa-times"></i> Incorrecto. La respuesta correcta es: ${question.options[question.correct]}</div>`;
            }
        }

        function nextQuestion() {
            const questions = medicalData.evaluacion.quizzes[currentQuiz];
            if (currentQuizIndex < questions.length - 1) {
                currentQuizIndex++;
                showQuizQuestion();
            } else {
                // Finalizar quiz
                const quizDisplay = document.getElementById('quizDisplay');
                const score = Math.round(((currentQuizIndex + 1) / questions.length) * 100);
                medicalData.evaluacion.progress.scores[currentQuiz] = score;
                medicalData.evaluacion.progress.completedQuizzes.push({
                    quiz: currentQuiz,
                    score: score,
                    date: new Date().toISOString()
                });
                
                // Actualizar categorías recientes
                if (!medicalData.evaluacion.progress.recentCategories.includes(currentQuiz)) {
                    medicalData.evaluacion.progress.recentCategories.push(currentQuiz);
                }
                
                quizDisplay.innerHTML = `
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-clipboard-check card-icon"></i>
                            <h3 class="card-title">Quiz Completado</h3>
                        </div>
                        <div class="card-body">
                            <h3>Resultados</h3>
                            <p>Has completado el quiz de ${currentQuiz} con una puntuación de ${score}%.</p>
                            <div class="action-buttons">
                                <button class="btn btn-primary" onclick="startQuiz('${currentQuiz}')">Intentar de nuevo</button>
                                <button class="btn btn-secondary" onclick="document.getElementById('quizDisplay').innerHTML = ''">Cerrar</button>
                            </div>
                        </div>
                    </div>
                `;
                
                saveToLocalStorage();
            }
        }

        function prevQuestion() {
            if (currentQuizIndex > 0) {
                currentQuizIndex--;
                showQuizQuestion();
            }
        }

        // Función para cambiar de categoría
        function activateCategory(category) {
            // Actualizar botones de categoría
            document.querySelectorAll('.cat-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.cat-btn[data-cat="${category}"]`).classList.add('active');
            
            // Actualizar contenido
            currentCategory = category;
            renderContent(category);
            
            // Añadir al historial
            addToHistory(category);
        }

        // Inicialización
        function initApp() {
            // Cargar datos guardados
            loadFromLocalStorage();
            
            // Configurar event listeners
            document.querySelectorAll('.cat-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const category = this.getAttribute('data-cat');
                    activateCategory(category);
                });
            });
            
            // Configurar búsqueda
            document.getElementById('searchInput').addEventListener('input', function() {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(handleSearch, 300);
            });
            
            // Cerrar sugerencias al hacer clic fuera
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.search-container')) {
                    document.getElementById('searchSuggestions').style.display = 'none';
                }
            });
            
            // Configurar tema
            document.getElementById('themeToggle').addEventListener('click', function() {
                if (theme === 'light') {
                    theme = 'dark';
                    document.body.style.background = 'linear-gradient(135deg, #1a202c 0%, #2d3748 100%)';
                    this.innerHTML = '<i class="fas fa-sun"></i>';
                } else {
                    theme = 'light';
                    document.body.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
                    this.innerHTML = '<i class="fas fa-moon"></i>';
                }
                saveToLocalStorage();
            });
            
            // Inicializar contenido
            renderContent(currentCategory);
            
            // Inicializar simulador si está activo
            if (currentCategory === 'simulador') {
                initializeVitals();
            }
        }

        // Iniciar la aplicación cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
